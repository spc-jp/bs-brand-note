<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BS Brand Note | 社長の想いを、事業の武器に。</title>
    <!-- Tailwind CSS (Design System) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts (Noto Sans JP) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7', // Trust Blue
                            700: '#0369a1',
                            900: '#0c4a6e',
                        },
                        accent: {
                            500: '#f59e0b', // Action Orange
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            /* Desktop: Prevent whole page scroll, handle in columns */
            height: 100vh;
            overflow: hidden; 
        }
        
        /* Mobile: Allow normal scrolling */
        @media (max-width: 1024px) {
            body {
                height: auto;
                overflow: auto;
            }
        }
        
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card-shadow:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Improved Scrollbar Styling */
        .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 transparent;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 10px; /* Slightly wider for easier grabbing */
            height: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent; 
            margin: 4px 0;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 6px;
            border: 2px solid rgba(0,0,0,0); /* Creates padding effect */
            background-clip: padding-box;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
            border: 2px solid rgba(0,0,0,0);
            background-clip: padding-box;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #475569;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        
        /* Tab Styles */
        .tab-active {
            background-color: #0284c7;
            color: #ffffff;
            font-weight: 700;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transform: translateY(-1px);
        }
        .dark .tab-active {
            background-color: #0ea5e9;
            color: #ffffff;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }
        .tab-inactive {
            color: #64748b;
            font-weight: 500;
            background-color: transparent;
        }
        .tab-inactive:hover {
            color: #334155;
            background-color: rgba(0, 0, 0, 0.05);
        }
        .dark .tab-inactive:hover {
            color: #cbd5e1;
            background-color: rgba(255, 255, 255, 0.05);
        }

        /* Category Tab Styles */
        .cat-btn {
            position: relative;
            transition: all 0.2s;
        }
        .cat-btn.active {
            color: #0284c7;
            font-weight: 700;
        }
        .cat-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #0284c7;
            border-radius: 3px 3px 0 0;
        }
        .dark .cat-btn.active {
            color: #38bdf8;
        }
        .dark .cat-btn.active::after {
            background-color: #38bdf8;
        }

        /* Sub Tab Styles */
        .sub-tab-active {
            background-color: #0284c7;
            color: #ffffff;
            font-weight: 700;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .dark .sub-tab-active {
            background-color: #0ea5e9;
        }
        .sub-tab-inactive {
            background-color: transparent;
            color: #64748b;
        }
        .sub-tab-inactive:hover {
            background-color: rgba(0,0,0,0.05);
        }
        .dark .sub-tab-inactive:hover {
            background-color: rgba(255,255,255,0.05);
        }

        .toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 16px;
            position: fixed;
            z-index: 50;
            left: 50%;
            bottom: 30px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s, bottom 0.3s;
        }
        .toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 50px;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 dark:bg-slate-900 dark:text-slate-100 flex flex-col h-screen overflow-hidden">

    <!-- Header -->
    <header class="bg-brand-900 text-white shadow-lg sticky top-0 z-40 flex-none h-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex items-center justify-between">
            <!-- Logo & Title with Toggle Action -->
            <div class="flex items-center gap-3 cursor-pointer group" onclick="toggleAllDetails()" title="クリックで入力欄を折りたたみ">
                <!-- Logo Image: bs.jpg -->
                <img src="bs.jpg" alt="BS Logo" class="h-10 w-auto rounded bg-white p-0.5 shadow-sm group-hover:opacity-90 transition">
                
                <div>
                    <h1 class="font-bold text-lg leading-tight group-hover:text-brand-100 transition">BS Brand Note</h1>
                    <p class="text-[10px] text-brand-100 opacity-90 leading-tight group-hover:opacity-100 transition">社長の想いを、事業の武器に。</p>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleDarkMode()" class="p-2 rounded-full hover:bg-white/10 transition text-white/90 hover:text-white" title="ダークモード">
                    <i data-lucide="moon" class="h-5 w-5"></i>
                </button>
                <button onclick="openHelp()" class="p-2 rounded-full hover:bg-white/10 transition text-white/90 hover:text-white" title="使い方">
                    <i data-lucide="help-circle" class="h-5 w-5"></i>
                </button>
                <button onclick="openSettings()" class="p-2 rounded-full hover:bg-white/10 transition text-white/90 hover:text-white" title="設定・基本情報">
                    <i data-lucide="settings" class="h-5 w-5"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <!-- Modified height calculation to account for footer (100vh - 4rem header - 2rem footer = 6rem) -->
    <main class="flex-grow max-w-[1600px] w-full mx-auto p-4 sm:p-6 lg:p-8 grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8 h-[calc(100vh-6rem)] overflow-hidden">
        
        <!-- Left Column: Inputs (Improved Scroll) -->
        <section class="lg:col-span-5 flex flex-col gap-6 lg:h-full lg:overflow-y-auto custom-scrollbar pr-2 pb-24">
            <div class="flex justify-between items-center mb-1 sticky top-0 bg-slate-50 dark:bg-slate-900 z-10 py-2">
                <h2 class="text-xl font-bold flex items-center gap-2 text-brand-700 dark:text-brand-400">
                    <i data-lucide="pen-tool" class="h-5 w-5"></i> 思考の整理（入力）
                </h2>
                <div class="text-xs text-slate-500 font-medium" id="saveStatus"></div>
            </div>

            <!-- Tone Selector -->
            <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 flex-shrink-0">
                <label class="text-xs font-bold text-slate-500 uppercase mb-2 block">出力トーン（語り口）</label>
                <div class="flex bg-slate-100 dark:bg-slate-900 rounded-lg p-1">
                    <button class="tone-btn flex-1 py-2 text-sm rounded-md font-medium transition active-tone" data-tone="polite" onclick="setTone('polite')">丁寧・誠実</button>
                    <button class="tone-btn flex-1 py-2 text-sm rounded-md font-medium transition text-slate-500" data-tone="passion" onclick="setTone('passion')">熱量・想い</button>
                    <button class="tone-btn flex-1 py-2 text-sm rounded-md font-medium transition text-slate-500" data-tone="friendly" onclick="setTone('friendly')">親しみ・相談</button>
                </div>
            </div>

            <!-- Section A: Passion -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0" open>
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">A. 社長の想い・ストーリー</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">なぜこの事業をやっている？（原体験）</label>
                        <!-- Preset Select -->
                        <div class="relative">
                            <select id="select_story_why" class="w-full appearance-none bg-brand-50 dark:bg-slate-700 border border-brand-200 dark:border-slate-600 rounded-lg py-2 px-3 mb-2 text-xs text-brand-700 dark:text-slate-300 outline-none transition hover:bg-brand-100 dark:hover:bg-slate-600 cursor-pointer font-medium" onchange="applyPreset('input_story_why', this.value)">
                                <option value="">▼ 例文を選択して入力（クリックで反映）</option>
                                <option value="中小企業には、&#13;&#10;それぞれの歴史があり、&#13;&#10;それぞれの事情があり、&#13;&#10;それぞれの“らしさ”があります。&#13;&#10;私たちは、&#13;&#10;&#13;&#10;その“らしさ”を壊すDXではなく、&#13;&#10;&#13;&#10;その“らしさ”を活かすDXを一緒に考えたい。&#13;&#10;ITが得意な会社だけが伸びる時代ではなく、&#13;&#10;&#13;&#10;ITが苦手な会社ほど、&#13;&#10;ちゃんと支えられる存在でありたい。">例文：その“らしさ”を活かすDX（中小企業支援）</option>
                            </select>
                            <i data-lucide="chevron-down" class="absolute right-3 top-2.5 h-4 w-4 text-brand-400 pointer-events-none"></i>
                        </div>
                        <textarea id="input_story_why" rows="3" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize leading-relaxed" placeholder="ここに自由に入力することもできます。"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">大切にしている価値観</label>
                        <!-- Preset Select -->
                        <div class="relative">
                            <select id="select_values" class="w-full appearance-none bg-brand-50 dark:bg-slate-700 border border-brand-200 dark:border-slate-600 rounded-lg py-2 px-3 mb-2 text-xs text-brand-700 dark:text-slate-300 outline-none transition hover:bg-brand-100 dark:hover:bg-slate-600 cursor-pointer font-medium" onchange="applyPreset('input_values', this.value)">
                                <option value="">▼ 例文を選択して入力（クリックで反映）</option>
                                <option value="埼玉を拠点に、&#13;&#10;地域の中小企業と一緒に歩んできたことは&#13;&#10;私たちの誇りです。&#13;&#10;顔が見える距離感で、&#13;&#10;&#13;&#10;何かあればすぐ駆けつける。&#13;&#10;地域の会社が元気になることが、&#13;&#10;&#13;&#10;この街の未来をつくると&#13;&#10;本気で思っています。">例文：地域密着・伴走支援（埼玉拠点）</option>
                            </select>
                            <i data-lucide="chevron-down" class="absolute right-3 top-2.5 h-4 w-4 text-brand-400 pointer-events-none"></i>
                        </div>
                        <textarea id="input_values" rows="3" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize leading-relaxed" placeholder="例：現場主義、わかりやすい言葉で伝える"></textarea>
                    </div>
                </div>
            </details>

            <!-- Section B: Strengths -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0">
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">B. 会社の強み</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-5">
                    <div class="grid grid-cols-2 gap-3">
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="地域密着">
                            <span>地域密着</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="一貫対応">
                            <span>一貫対応</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="初心者にも優しい">
                            <span>ITが苦手でも安心</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="スピード対応">
                            <span>スピード対応</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="伴走型">
                            <span>伴走型サポート</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="実績豊富">
                            <span>実績が豊富</span>
                        </label>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">独自の強み（自由記述）</label>
                        <textarea id="input_strength_custom" rows="2" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize" placeholder="例：元銀行員が資金繰りまでサポートします"></textarea>
                    </div>
                </div>
            </details>

            <!-- Section C: Target -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0">
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">C. ターゲット</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-3">
                    <div class="space-y-3">
                        <label class="flex items-center space-x-3 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded transition">
                            <input type="radio" name="target" value="ceo" class="text-brand-600 focus:ring-brand-500 h-4 w-4" checked>
                            <span>中小企業の経営者（忙しい・孤独）</span>
                        </label>
                        <label class="flex items-center space-x-3 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded transition">
                            <input type="radio" name="target" value="admin" class="text-brand-600 focus:ring-brand-500 h-4 w-4">
                            <span>総務・経理担当（業務過多）</span>
                        </label>
                        <label class="flex items-center space-x-3 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded transition">
                            <input type="radio" name="target" value="legacy" class="text-brand-600 focus:ring-brand-500 h-4 w-4">
                            <span>IT・デジタルが苦手な企業</span>
                        </label>
                        <label class="flex items-center space-x-3 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded transition">
                            <input type="radio" name="target" value="growth" class="text-brand-600 focus:ring-brand-500 h-4 w-4">
                            <span>補助金活用・DX検討企業</span>
                        </label>
                    </div>
                </div>
            </details>

            <!-- Section D: SDGs -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0">
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">D. SDGs・社会貢献</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">注力する目標（番号を選択）</label>
                        <div class="flex flex-wrap gap-2">
                            <label class="cursor-pointer"><input type="checkbox" class="sdgs-check hidden peer" value="8"><span class="px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 peer-checked:bg-[#A21942] peer-checked:text-white transition shadow-sm">8.働きがい</span></label>
                            <label class="cursor-pointer"><input type="checkbox" class="sdgs-check hidden peer" value="9"><span class="px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 peer-checked:bg-[#FD6925] peer-checked:text-white transition shadow-sm">9.産業基盤</span></label>
                            <label class="cursor-pointer"><input type="checkbox" class="sdgs-check hidden peer" value="11"><span class="px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 peer-checked:bg-[#FD9D24] peer-checked:text-white transition shadow-sm">11.まちづくり</span></label>
                            <label class="cursor-pointer"><input type="checkbox" class="sdgs-check hidden peer" value="17"><span class="px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 peer-checked:bg-[#19486A] peer-checked:text-white transition shadow-sm">17.パートナー</span></label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">実現したい未来</label>
                        <textarea id="input_sdgs_future" rows="2" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize" placeholder="例：地域の企業がずっと存続できる社会"></textarea>
                    </div>
                </div>
            </details>

            <!-- Section E: Achievements -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0">
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">E. 実績・事例</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">代表的な事例・効果</label>
                        <textarea id="input_case" rows="2" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize" placeholder="例：アナログ管理だった製造業様が、クラウド導入で残業時間を50%削減。"></textarea>
                    </div>
                </div>
            </details>

            <!-- Section F: Recruitment (New) -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0" open>
                <summary class="flex justify-between items-center p-4 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-sm text-slate-700 dark:text-slate-200">F. 採用したい人物像</h3>
                    <i data-lucide="chevron-down" class="h-4 w-4 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-4 space-y-2">
                    <textarea id="input_recruit_target" rows="3" class="w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-2.5 text-sm outline-none auto-resize" placeholder="例：20代～30代、IT未経験でも成長意欲がある、顧客の役に立ちたいという想いがある"></textarea>
                </div>
            </details>

            <!-- Section G: Growth (New) -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0" open>
                <summary class="flex justify-between items-center p-4 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-sm text-slate-700 dark:text-slate-200">G. 育成したい未来像</h3>
                    <i data-lucide="chevron-down" class="h-4 w-4 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-4 space-y-2">
                    <textarea id="input_growth_vision" rows="3" class="w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-2.5 text-sm outline-none auto-resize" placeholder="例：3年後にリーダーとしてチームを牽引できる、新サービスの開発に参加できる"></textarea>
                </div>
            </details>

            <!-- Save Status moved here -->
            <div class="text-xs text-slate-400 font-medium text-center mb-1 transition-opacity duration-300 min-h-[1em]" id="saveStatus"></div>

            <button onclick="generateAll()" class="w-full bg-brand-600 hover:bg-brand-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg shadow-brand-500/30 transition transform hover:-translate-y-0.5 active:translate-y-0 flex items-center justify-center gap-2 flex-shrink-0 mb-4">
                <i data-lucide="wand-2" class="h-5 w-5"></i> 保存して生成
            </button>
            
            <div class="flex justify-center gap-4 text-[10px] text-slate-400 pb-2">
                <button onclick="loadDemoData()" class="hover:text-brand-500 hover:underline">デモデータを入力</button>
                <button onclick="clearAllData()" class="hover:text-red-500 hover:underline">デモデータクリア</button>
            </div>
        </section>

        <!-- Right Column: Outputs -->
        <section class="lg:col-span-7 flex flex-col lg:h-full overflow-hidden">
            <div class="flex justify-between items-center mb-4 flex-shrink-0">
                <h2 class="text-xl font-bold flex items-center gap-2 text-slate-800 dark:text-white">
                    <i data-lucide="monitor-up" class="h-5 w-5 text-accent-500"></i> 資産化アウトプット
                </h2>
                <button onclick="generateAll()" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 py-1.5 px-3 rounded-lg font-bold flex items-center gap-1 transition">
                    <i data-lucide="rotate-cw" class="h-3 w-3"></i> リセット
                </button>
            </div>

            <!-- Category Tabs (Main) -->
            <div class="flex space-x-1 bg-slate-100 dark:bg-slate-800 p-1 rounded-xl mb-3 flex-shrink-0">
                <button class="cat-btn flex-1 py-3 text-sm font-medium text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200 transition active" onclick="switchCategory('branding', this)">
                    <i data-lucide="megaphone" class="h-4 w-4 inline mr-1"></i> ブランド発信
                </button>
                <button class="cat-btn flex-1 py-3 text-sm font-medium text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200 transition" onclick="switchCategory('recruit', this)">
                    <i data-lucide="user-plus" class="h-4 w-4 inline mr-1"></i> 採用
                </button>
                <button class="cat-btn flex-1 py-3 text-sm font-medium text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200 transition" onclick="switchCategory('growth', this)">
                    <i data-lucide="sprout" class="h-4 w-4 inline mr-1"></i> 育成
                </button>
            </div>

            <!-- Sub Tabs (Only for Branding) -->
            <div id="subTabs" class="flex overflow-x-auto space-x-2 pb-2 mb-2 flex-shrink-0 custom-scrollbar" style="min-height: 44px;">
                <button data-sub="web" class="sub-tab-active px-3 py-1.5 rounded-lg text-xs font-bold whitespace-nowrap transition" onclick="switchSubTab('web', this)">Web・HP用</button>
                <button data-sub="sns" class="sub-tab-inactive px-3 py-1.5 rounded-lg text-xs font-bold whitespace-nowrap transition" onclick="switchSubTab('sns', this)">SNS投稿</button>
                <button data-sub="sales" class="sub-tab-inactive px-3 py-1.5 rounded-lg text-xs font-bold whitespace-nowrap transition" onclick="switchSubTab('sales', this)">営業トーク</button>
                <button data-sub="exhibition" class="sub-tab-inactive px-3 py-1.5 rounded-lg text-xs font-bold whitespace-nowrap transition" onclick="switchSubTab('exhibition', this)">展示会・チラシ</button>
                <button data-sub="sdgs" class="sub-tab-inactive px-3 py-1.5 rounded-lg text-xs font-bold whitespace-nowrap transition" onclick="switchSubTab('sdgs', this)">SDGs宣言</button>
            </div>

            <!-- Output Container (Scrollable) -->
            <div class="flex-grow overflow-y-auto pr-2 pb-24 custom-scrollbar space-y-6" id="outputContainer">
                <!-- Content will be injected here by JS -->
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="flex-none h-8 bg-slate-100 dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 flex items-center justify-center text-[10px] text-slate-400">
        テスト版（ベータ版） © 2026 SPC
    </footer>

    <!-- Toast -->
    <div id="toast" class="toast shadow-xl"><div class="flex items-center justify-center gap-2"><i data-lucide="check-circle" class="h-5 w-5 text-green-400"></i> <span>コピーしました！</span></div></div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-md w-full p-6 transform transition-all scale-100 h-[80vh] overflow-y-auto custom-scrollbar">
            <div class="flex justify-between items-center mb-4 sticky top-0 bg-white dark:bg-slate-800 pb-2 z-10 border-b border-slate-100 dark:border-slate-700">
                <h3 class="text-lg font-bold">設定・基本情報</h3>
                <button onclick="closeModal('settingsModal')" class="text-slate-400 hover:text-slate-600"><i data-lucide="x" class="h-6 w-6"></i></button>
            </div>
            
            <div class="space-y-6">
                <!-- Basic Info Section (Moved from Main) -->
                <div class="bg-slate-50 dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-700">
                    <h4 class="text-sm font-bold text-brand-600 dark:text-brand-400 mb-3 flex items-center gap-1"><i data-lucide="building-2" class="h-4 w-4"></i> 会社の基本情報</h4>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">会社名</label>
                            <input type="text" id="input_companyName" class="w-full bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg p-2.5 text-sm focus:ring-2 focus:ring-brand-500 outline-none" placeholder="例：株式会社ビジネスサポート">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">所在地</label>
                            <input type="text" id="input_location" class="w-full bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg p-2.5 text-sm outline-none" placeholder="例：東京都中央区">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">事業内容</label>
                            <textarea id="input_business" rows="2" class="w-full bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg p-2.5 text-sm outline-none" placeholder="例：中小企業のIT導入支援、業務改善コンサルティング"></textarea>
                        </div>
                    </div>
                </div>

                <!-- App Settings Section -->
                <div>
                    <h4 class="text-sm font-bold text-slate-700 dark:text-slate-300 mb-3 border-l-4 border-slate-300 pl-2">アプリ設定</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">文章の署名（フッター）</label>
                            <input type="text" id="setting_sign" class="w-full bg-slate-50 dark:bg-slate-900 border rounded p-2 text-sm" value="株式会社ビジネスサポート">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">自社URL</label>
                            <input type="text" id="setting_url" class="w-full bg-slate-50 dark:bg-slate-900 border rounded p-2 text-sm" placeholder="https://example.com">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">GoogleマップURL</label>
                            <input type="text" id="setting_mapUrl" class="w-full bg-slate-50 dark:bg-slate-900 border rounded p-2 text-sm" placeholder="https://maps.app.goo.gl/...">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">NGワード設定（カンマ区切り）</label>
                            <textarea id="setting_ng" class="w-full bg-slate-50 dark:bg-slate-900 border rounded p-2 text-sm h-20">絶対,No.1,必ず,業界初,完璧,唯一</textarea>
                            <p class="text-[10px] text-red-500 mt-1">※誇大広告防止のため、これらの単語が含まれると警告を表示します。</p>
                        </div>
                    </div>
                </div>

                <div class="pt-2 sticky bottom-0 bg-white dark:bg-slate-800 pb-2">
                    <button onclick="saveSettings(); closeModal('settingsModal')" class="w-full bg-brand-600 text-white py-3 rounded-lg font-bold hover:bg-brand-700 shadow-md">保存して閉じる</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-lg w-full p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold flex items-center gap-2"><i data-lucide="book-open" class="h-5 w-5 text-accent-500"></i> 使い方 3ステップ</h3>
                <button onclick="closeModal('helpModal')" class="text-slate-400 hover:text-slate-600"><i data-lucide="x" class="h-6 w-6"></i></button>
            </div>
            
            <!-- Purpose Section -->
            <div class="bg-brand-50 dark:bg-brand-900/30 p-4 rounded-xl mb-6 border border-brand-100 dark:border-brand-800">
                <h4 class="text-brand-800 dark:text-brand-300 font-bold mb-2 flex items-center gap-2 text-sm">
                    <i data-lucide="target" class="h-4 w-4"></i> アプリの目的
                </h4>
                <p class="text-brand-700 dark:text-brand-400 leading-relaxed text-sm">
                    本アプリは、経営者様の内に秘めた「熱い想い」や企業の「独自の強み」を言語化し、Webサイト・営業活動・SNS発信などで即戦力となる言葉へと変換する『事業資産化ツール』でございます。
                </p>
            </div>

            <div class="space-y-6 text-sm text-slate-600 dark:text-slate-300">
                <div class="flex gap-4">
                    <div class="bg-brand-100 text-brand-600 font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">1</div>
                    <div>
                        <h4 class="font-bold text-slate-800 dark:text-white mb-1">基本情報をご登録ください</h4>
                        <p class="leading-relaxed">画面右上の「<i data-lucide="settings" class="h-3 w-3 inline"></i>」ボタン（設定）より、貴社の基本情報（社名や事業内容など）をご入力ください。</p>
                    </div>
                </div>
                <div class="flex gap-4">
                    <div class="bg-brand-100 text-brand-600 font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">2</div>
                    <div>
                        <h4 class="font-bold text-slate-800 dark:text-white mb-1">想いや強みを整理・入力します</h4>
                        <p class="leading-relaxed">画面左側の入力エリアにて、経営に対する想い、自社の強み、ターゲット層などについて、問いかけに答える形でご入力ください。</p>
                    </div>
                </div>
                <div class="flex gap-4">
                    <div class="bg-brand-100 text-brand-600 font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">3</div>
                    <div>
                        <h4 class="font-bold text-slate-800 dark:text-white mb-1">文章を生成し、活用します</h4>
                        <p class="leading-relaxed">入力内容に基づき、画面右側に用途別の文章が自動生成されます。目的に合った文章を選び、コピーしてWebサイトやSNS等でご活用ください。</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Initialization ---
        lucide.createIcons();

        // --- State Management ---
        let currentCategory = 'branding';
        let currentSubTab = 'web';
        let currentTone = 'polite';
        
        const defaultData = {
            companyName: '株式会社ビジネスサポート',
            location: '〒336-0017 埼玉県さいたま市南区南浦和３丁目４４−１８',
            business: '中小企業支援、経営コンサルティング',
            story_why: '素晴らしい技術を持つ中小企業が、伝え方を知らないだけで損をしている現状を変えたい。',
            values: '「伴走」と「実利」',
            strengths: ['地域密着', '伴走型サポート'],
            strength_custom: '',
            target: 'ceo', // ceo, admin, legacy, growth
            sdgs: ['8', '9'],
            sdgs_future: '地域の雇用を守り、次世代にバトンを繋ぐ',
            case_study: '赤字続きだった製造業が、工程見直しによりV字回復を達成。',
            settings: {
                sign: '株式会社ビジネスサポート',
                url: 'https://bs-saitama.jp/',
                mapUrl: 'https://maps.app.goo.gl/UGs9YNetsSM7ELRk8',
                ng: '絶対,No.1,必ず,業界初,完璧,唯一'
            }
        };

        // --- Logic: Data Handling ---
        function loadData() {
            const saved = localStorage.getItem('bs_brand_note_data');
            if (saved) {
                const data = JSON.parse(saved);
                // Apply Inputs (Basic Info now in Modal)
                document.getElementById('input_companyName').value = data.companyName || '';
                document.getElementById('input_location').value = data.location || '';
                document.getElementById('input_business').value = data.business || '';
                
                // Other Inputs
                document.getElementById('input_story_why').value = data.story_why || '';
                document.getElementById('input_values').value = data.values || '';
                document.getElementById('input_strength_custom').value = data.strength_custom || '';
                document.getElementById('input_sdgs_future').value = data.sdgs_future || '';
                document.getElementById('input_case').value = data.case_study || '';
                document.getElementById('input_recruit_target').value = data.recruit_target || '';
                document.getElementById('input_growth_vision').value = data.growth_vision || '';
                
                const targetRadio = document.querySelector(`input[name="target"][value="${data.target}"]`);
                if (targetRadio) targetRadio.checked = true;

                // Checkboxes Strength
                document.querySelectorAll('.strength-check').forEach(cb => {
                    cb.checked = data.strengths.includes(cb.value);
                });

                // Checkboxes SDGs
                document.querySelectorAll('.sdgs-check').forEach(cb => {
                    cb.checked = data.sdgs.includes(cb.value);
                });

                // Settings
                if (data.settings) {
                    document.getElementById('setting_sign').value = data.settings.sign || '';
                    document.getElementById('setting_url').value = data.settings.url || '';
                    document.getElementById('setting_mapUrl').value = data.settings.mapUrl || '';
                    document.getElementById('setting_ng').value = data.settings.ng || '';
                }
            } else {
                // Load defaults if empty
                document.getElementById('input_companyName').value = defaultData.companyName;
                document.getElementById('input_location').value = defaultData.location;
                document.getElementById('input_business').value = defaultData.business;
                document.getElementById('setting_url').value = defaultData.settings.url;
                document.getElementById('setting_mapUrl').value = defaultData.settings.mapUrl;
                
                generateAll(); // Initial Gen
            }
        }

        function saveData() {
            const strengths = Array.from(document.querySelectorAll('.strength-check:checked')).map(cb => cb.value);
            const sdgs = Array.from(document.querySelectorAll('.sdgs-check:checked')).map(cb => cb.value);
            const target = document.querySelector('input[name="target"]:checked')?.value || 'ceo';

            const data = {
                companyName: document.getElementById('input_companyName').value,
                location: document.getElementById('input_location').value,
                business: document.getElementById('input_business').value,
                story_why: document.getElementById('input_story_why').value,
                values: document.getElementById('input_values').value,
                strengths: strengths,
                strength_custom: document.getElementById('input_strength_custom').value,
                target: target,
                sdgs: sdgs,
                sdgs_future: document.getElementById('input_sdgs_future').value,
                case_study: document.getElementById('input_case').value,
                recruit_target: document.getElementById('input_recruit_target').value,
                growth_vision: document.getElementById('input_growth_vision').value,
                settings: {
                    sign: document.getElementById('setting_sign').value,
                    url: document.getElementById('setting_url').value,
                    mapUrl: document.getElementById('setting_mapUrl').value,
                    ng: document.getElementById('setting_ng').value
                }
            };
            
            localStorage.setItem('bs_brand_note_data', JSON.stringify(data));
            
            // Show saving status
            const status = document.getElementById('saveStatus');
            status.textContent = '保存しました';
            status.classList.remove('opacity-0');
            setTimeout(() => status.classList.add('opacity-0'), 2000);
        }

        // --- Logic: Generator Core ---
        
        // Helper: Get Tone Suffix
        function t(polite, passion, friendly) {
            if (currentTone === 'passion') return passion;
            if (currentTone === 'friendly') return friendly;
            return polite;
        }

        function getInputs() {
            const strengths = Array.from(document.querySelectorAll('.strength-check:checked')).map(cb => cb.value);
            if(document.getElementById('input_strength_custom').value) {
                strengths.push(document.getElementById('input_strength_custom').value);
            }
            
            return {
                name: document.getElementById('input_companyName').value || '当社',
                loc: document.getElementById('input_location').value,
                biz: document.getElementById('input_business').value,
                why: document.getElementById('input_story_why').value,
                val: document.getElementById('input_values').value,
                str: strengths,
                target: document.querySelector('input[name="target"]:checked')?.value || 'ceo',
                sdgs: Array.from(document.querySelectorAll('.sdgs-check:checked')).map(cb => cb.value),
                future: document.getElementById('input_sdgs_future').value,
                case: document.getElementById('input_case').value,
                recruit_target: document.getElementById('input_recruit_target').value,
                growth_vision: document.getElementById('input_growth_vision').value,
                sign: document.getElementById('setting_sign').value,
                url: document.getElementById('setting_url').value,
                mapUrl: document.getElementById('setting_mapUrl').value,
                ngList: document.getElementById('setting_ng').value.split(',').map(s => s.trim()).filter(s => s)
            };
        }

        function checkNG(text, ngList) {
            const found = [];
            ngList.forEach(word => {
                if (text.includes(word)) found.push(word);
            });
            return found;
        }

        function getCompanyProfile(d) {
            return `【会社概要】\n社名：${d.name}\n所在地：${d.loc}\n事業内容：${d.biz}\n\n【想い・価値観】\n${d.why || '未入力'}\n\n大切にしていること：${d.val || '未入力'}\n\n【強み】\n${d.str.join('、') || '未入力'}\n\n【実績】\n${d.case || '未入力'}\n\n【目指す未来】\n${d.future || '未入力'}\n\n【求める人物像】\n${d.recruit_target || '未入力'}\n\n【育成ビジョン】\n${d.growth_vision || '未入力'}`;
        }

        // --- Generators ---

        function genWeb(d) {
            let strList = d.str.length > 0 ? d.str.join('、') : '独自のノウハウ';
            let targetCall = '';
            
            if(d.target === 'ceo') targetCall = '経営者の皆様、孤独な決断をサポートします。';
            if(d.target === 'admin') targetCall = 'バックオフィスの負担を劇的に軽減します。';
            if(d.target === 'legacy') targetCall = '「ITは難しい」と諦めていませんか？';
            if(d.target === 'growth') targetCall = '次なる成長のためのDXを共に実現します。';

            // Catch Copies
            const copy1 = `${d.loc}から、${d.future || '企業の未来'}を創る。${d.name}です。`;
            const copy2 = `${targetCall}\n${strList}で、あなたの事業を加速させます。`;
            const copy3 = `${d.val}を大切に。${d.biz}ならお任せください。`;

            // Intro Text
            let intro = `${d.name}は、${d.loc}を拠点に${d.biz}を展開しています。\n\n創業以来、「${d.why}」という想いで活動を続けてきました。私たちの強みは${strList}です。\n\n${targetCall}お客様のパートナーとして、${d.future || '共に歩みを進めて'}まいります。`;
            
            if (d.mapUrl) {
                intro += `\n\nアクセス: ${d.mapUrl}`;
            }

            return [
                { title: 'トップページ用キャッチコピー A', text: copy1 },
                { title: 'トップページ用キャッチコピー B', text: copy2 },
                { title: '会社紹介文 (About Us)', text: intro },
                { title: '強みの箇条書き', text: d.str.map(s => `・${s}`).join('\n') }
            ];
        }

        function genSales(d) {
            let opening = '';
            if (currentTone === 'polite') opening = `お世話になっております。${d.name}です。`;
            else if (currentTone === 'passion') opening = `お世話になります！${d.name}です！`;
            else opening = `こんにちは、${d.name}です。`;

            let pain = '';
            if(d.target === 'ceo') pain = '経営課題の解決や、将来への投資についてお悩みではありませんか？';
            if(d.target === 'legacy') pain = '業務のデジタル化を進めたいけれど、何から始めればいいか分からない…ということはありませんか？';

            const talk30 = `${opening}\n\n私たちは${d.loc}で${d.biz}を行っています。\n特に${d.str[0] || 'サポート体制'}には自信があり、${d.case || '多くのお客様'}にご評価いただいています。\n\n${pain}\nもしよろしければ、一度資料だけでもご覧いただけないでしょうか。`;

            let email = `${opening}\n\n貴社のWebサイトを拝見し、ご連絡いたしました。\n\n弊社は${d.biz}を専門としており、特に「${d.val}」という価値観を大切にしています。\n\nこれまでに${d.case}といった実績がございます。\n\n${d.str.join('、')}といった強みを活かし、貴社のお役に立てるのではないかと考えました。\n\n詳細な事例資料もございますので、一度情報交換のお時間をいただけないでしょうか。\n\n--------------------------------\n${d.sign}\n${d.url}`;
            
            if (d.mapUrl) {
                email += `\nMap: ${d.mapUrl}`;
            }
            email += `\n--------------------------------`;

            return [
                { title: '30秒エレベーターピッチ', text: talk30 },
                { title: '初回アプローチメール', text: email },
                { title: '問い合わせ返信', text: `${opening}\nこの度は、お問い合わせいただき誠にありがとうございます。\n\nご質問いただいた件につきまして、以下の通り回答いたします。\n\n（ここに回答を入力）\n\n私たちの強みである「${d.str[0] || '対応力'}」を活かし、貴社の課題解決に貢献できれば幸いです。\n引き続きよろしくお願いいたします。\n\n--------------------------------\n${d.sign}` }
            ];
        }

        function genExhibition(d) {
            return [
                { title: 'パネル・ポスター見出し', text: `【${d.str[0] || '解決策'}】${d.biz}なら${d.name}へ` },
                { title: '来場者に刺さる一言 (POP)', text: d.target === 'legacy' ? '「ITが苦手」でも大丈夫！' : 'その経営課題、3分で診断！' },
                { title: 'チラシ用リード文', text: `もう一人で悩まないでください。\n${d.loc}の${d.name}が、あなたの会社の「${d.val}」を守ります。\n\n実績：${d.case}` },
                { title: 'QRコード誘導', text: '詳細事例・ノウハウ集はこちらからスマホでチェック▼' }
            ];
        }

        function genSNS(d) {
            const tags = `#${d.name.replace(/\s+/g, '')} #${d.loc} #中小企業支援 #${d.biz.split('、')[0]}`;
            const mapLink = d.mapUrl ? `\n\n📍アクセス\n${d.mapUrl}` : '';
            const toneEnd = t('です。', 'だ！', 'ですね✨');
            const emoji = t('🙇‍♂️', '🔥', '😊');

            // Google Maps (Business Profile)
            const googleMap = `【お知らせ】${d.case}\n\n${d.name}です。\nお客様より嬉しいお声をいただきました。\n\n私たちは${d.loc}で${d.biz}を行っています。\n「${d.val}」を大切に、${d.str[0] || '地域'}の皆様をサポートします。\n\nお困りの際はぜひご相談ください。${mapLink}`;

            // Facebook (Storytelling, polite)
            const fb = `【${d.name}の想い】\nこんにちは、${d.name}です。\n\n私たちは創業以来、「${d.why}」という想いで${d.loc}の皆様と共に歩んできました。\n\n最近では、${d.case}といった事例も増えています。\n\n私たちが大切にしているのは「${d.val}」です。\nこれからも${d.future || '地域社会'}に貢献できるよう尽力してまいります。\n\n詳しくはこちら：\n${d.url}\n${tags}`;

            // Instagram (Visual, emotional, hashtags)
            const insta = `【事例紹介】${d.case}${emoji}\n.\nお客様の笑顔が私たちの原動力です✨\n.\n${d.name}の強みは「${d.str[0] || '対応力'}」！\n「${d.val}」をモットーに、${d.loc}で活動中💨\n.\n気になった方はプロフィールのリンクをチェック👀\n👇\n@（アカウント名）\n.\n${tags} #経営者 #企業公式 #ビジネス`;

            // X (Twitter) (Short, conclusion first)
            const x = `【実績】${d.case}\n\n実は「${d.str[0] || 'これ'}」が私たちの強みなんです${toneEnd}\n\n${d.loc}で${d.biz}なら${d.name}へ！\n「${d.val}」の精神でサポートします${emoji}\n\n詳細はこちら👇\n${d.url}\n${tags}`;

            // LINE (Friendly, direct action)
            const line = `こんにちは！${d.name}です${emoji}\n\n${d.loc}の事業者様へ、こんなお悩みありませんか？\n\n✅ ${d.case}\n\n私たちは${d.str.join('、')}で解決をサポートします！\n\nまずは「${d.val}」の精神で、お話をお聞きします。\n\n👇無料相談はこちらから\n（LINEのボタンやリッチメニューへ誘導）`;

            const items = [
                { title: 'Googleマップ (最新情報)', text: googleMap },
                { title: 'Facebook (信頼構築)', text: fb },
                { title: 'Instagram (共感・認知)', text: insta },
                { title: 'X / Twitter (拡散・速報)', text: x },
                { title: 'LINE公式 (ファン化)', text: line }
            ];

            // Added Banner Item
            items.push({
                title: '画像・動画素材フォルダ',
                text: '画像：外観、内観、お客様\n動画：外観、内観、お客様',
                type: 'folder'
            });

            return items;
        }

        function genSDGs(d) {
            const goals = d.sdgs.map(n => `ゴール${n}`).join('、');
            
            const web = `${d.name}は、SDGs（持続可能な開発目標）の達成に貢献します。\n\n特に「${goals}」を重要課題と捉え、事業を通じて「${d.future}」を実現します。\n具体的な取り組みとして、${d.biz}を通じた地域企業の持続化支援を行っています。`;

            const talk = `弊社はSDGsにも力を入れておりまして、特に${goals}番に取り組んでいます。\n${d.future}を目指して、お客様と一緒に社会課題の解決に取り組んでいければと考えています。`;

            return [
                { title: 'Web掲載用 SDGs宣言', text: web },
                { title: '営業トーク用 SDGsアピール', text: talk },
                { title: '行政・入札用 説明文', text: `【SDGsへの取り組み方針】\n当社は、${d.biz}を通じて持続可能な社会の実現に寄与します。\n重点目標：${goals}\n\n具体的には、${d.str.join('、')}といった強みを活かし、地域経済の活性化と雇用の維持（ゴール8）に貢献しています。` }
            ];
        }

        function genRecruit(d) {
            const dataMsg = "「販売管理は入口。データから新しいサービスを一緒に作れる人になってほしい」";
            
            const catch1 = `「${d.future || '未来'}」を共に創る。\n${d.loc}発、${d.biz}のプロフェッショナル集団。`;
            const catch2 = `大切なのは「${d.val}」。\n${d.recruit_target || '未経験'}からでも成長できる環境です。`;
            const catch3 = `社長の想い「${d.why}」に共感してくれる、\n次世代のリーダー候補を募集します。`;

            const jobIntro = `【会社紹介】\n${d.name}は、${d.loc}を拠点に${d.biz}を展開しています。\n強みは「${d.str.join('、')}」です。\n現在、私たちと一緒に「${d.future || '未来'}」の実現を目指してくれる仲間を募集中。\n「${d.val}」という価値観を大切にできる方をお待ちしています。`;

            const story = `【仕事内容と成長ストーリー】\n■ 現在 (入社～1年)\nまずは${d.biz}の基礎を習得。${d.str[0]||'現場'}での実務を通じて、お客様の課題を肌で感じてください。\n\n■ 1年後\nプロジェクトの一部をお任せします。「${d.val}」を体現し、お客様から信頼される存在へ。\n\n■ 3年後 (未来)\n${d.growth_vision || '新規事業のコアメンバー'}として活躍を期待します。\n\n${dataMsg}\n私たちは単なる御用聞きではありません。お客様の未来を創るパートナーです。`;

            const interview = `【面接質問テンプレ】\n1. 当社の「${d.val}」についてどう感じましたか？\n2. ${d.recruit_target || 'これまでの経験'}で一番苦労したことは？\n3. ${d.future || '未来'}について、あなたのアイデアはありますか？\n4. 「データから新しいサービスを作る」という視点に関心はありますか？\n5. チームで働く上で大切にしていることは？\n6. ${d.str[0]||'強み'}以外で、当社に期待することは？\n7. 3年後、どんな自分になっていたいですか？\n8. 失敗した時、どう立ち直りますか？\n9. 最近、新しいことを学びましたか？\n10. 最後に、私たちに聞いておきたいことは？`;

            const welcome = `【内定者向け案内】\n内定おめでとうございます。\n${d.name}一同、あなたを歓迎します。\n私たちは「${d.why}」という想いで活動しています。\nあなたの「${d.recruit_target || '熱意'}」は私たちの大きな力になります。\n${dataMsg}という視点で、共に成長しましょう。\n\n【Googleマップ整備チェック】\n□ 外観写真は最新か？\n□ オフィスの内観は整理されているか？\n□ スタッフの笑顔の写真は掲載されているか？`;

            return [
                { title: '採用キャッチコピー 3案', text: `${catch1}\n\n${catch2}\n\n${catch3}` },
                { title: '求人票用 会社紹介文', text: jobIntro },
                { title: '仕事内容と成長ストーリー', text: story },
                { title: '面接質問テンプレ 10問', text: interview },
                { title: '内定者案内・Googleマップ整備', text: welcome }
            ];
        }

        function genGrowth(d) {
            const sheet = `【30代育成シート】\n名前：_____\n\n■ 期待する役割\n現場リーダーとして「${d.val}」を体現し、${d.growth_vision || '次世代の柱'}となる。\n\n■ 目標\n1. ${d.biz}のプロフェッショナル化\n2. データ活用視点の習得（販売管理のその先へ）\n3. 後輩への「${d.why}」の継承\n\n■ 強みと課題\n強み：${d.recruit_target || '実行力'}\n課題：経営視点での判断`;

            const ononone = `【1on1面談 質問集】\n1. 今月「${d.val}」を意識した行動は？\n2. 業務で「${d.str[0]||'強み'}」を活かせたか？\n3. ${d.future || '未来'}に向けて、今足りないものは？\n4. データ活用や新サービスへのアイデアはある？\n5. チームの雰囲気はどう？\n6. 健康面やプライベートで心配事は？\n7. 来月のチャレンジ目標は？\n8. 私（上司）にサポートしてほしいことは？\n9. ${d.case || '成功事例'}のような仕事を作るには？\n10. 3年後の自分をイメージできている？\n11. 最近読んだ本やニュースは？\n12. 会社の方向性に疑問はない？`;

            const kaizen = `【改善提案書 ひな型】\n■ 課題\n（例：${d.biz}の〇〇工程の手間）\n\n■ 原因\n（なぜ発生しているか深掘り）\n\n■ 提案\n（「${d.val}」に基づいた解決策）\n\n■ 期待効果\n（定量的・定性的なメリット）\n\n■ 次の一手\n（いつ誰がやるか）\n\n※例文：アナログ管理をデジタル化し、データ分析の基盤を作る`;

            const checklist = `【新人向け 初月チェックリスト】\n1週目：企業理念「${d.why}」の理解\n2週目：${d.biz}の基本フロー習得\n3週目：${d.str[0]||'強み'}の説明ができる\n4週目：日報で「${d.val}」を振り返る`;

            const roadmap = `【後継者育成ロードマップ】\n\nフェーズ0：理念継承\n・創業の精神「${d.why}」の体得\n・「${d.val}」の社内浸透\n\nフェーズ1：実務掌握\n・${d.biz}の全容把握\n・既存事業の安定運用\n\nフェーズ2：未来創造\n・「${d.future || '未来'}」の実現\n・データ起点の新サービス開発\n・${d.growth_vision || '新規事業'}の実行`;

            return [
                { title: '30代育成シート', text: sheet },
                { title: '1on1面談用 質問集 12問', text: ononone },
                { title: '改善提案書ひな型', text: kaizen },
                { title: '新人向け 初月チェックリスト', text: checklist },
                { title: '後継者育成ロードマップ', text: roadmap }
            ];
        }

        // --- Rendering ---
        function createCard(item, ngList) {
            // Special rendering for Folder Banner
            if (item.type === 'folder') {
                return `
                <div class="bg-brand-50 dark:bg-slate-800 rounded-xl p-4 border-2 border-dashed border-brand-300 dark:border-slate-600 hover:bg-brand-100 dark:hover:bg-slate-700 transition cursor-pointer group" onclick="openAssetFolder()">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="bg-brand-500 text-white p-3 rounded-lg">
                                <i data-lucide="folder-open" class="h-6 w-6"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-brand-700 dark:text-brand-300 text-base">画像・動画ホルダー</h3>
                                <p class="text-xs text-brand-600 dark:text-slate-400 mt-1">クリックして素材を確認</p>
                            </div>
                        </div>
                        <i data-lucide="chevron-right" class="h-5 w-5 text-brand-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <div class="mt-3 pl-14 text-sm text-slate-600 dark:text-slate-300 space-y-1">
                        <div class="flex items-center gap-2"><i data-lucide="image" class="h-4 w-4"></i> 画像：外観、内観、お客様</div>
                        <div class="flex items-center gap-2"><i data-lucide="film" class="h-4 w-4"></i> 動画：外観、内観、お客様</div>
                    </div>
                </div>
                `;
            }

            const ngFound = checkNG(item.text, ngList);
            let ngHtml = '';
            if (ngFound.length > 0) {
                ngHtml = `<div class="mt-2 p-3 bg-red-50 border border-red-100 rounded-lg text-sm text-red-700 flex flex-wrap items-start">
                    <i data-lucide="alert-triangle" class="h-4 w-4 mr-1.5 mt-0.5 flex-shrink-0"></i>
                    <span class="flex-1 leading-relaxed">注意：誇大表現の可能性があります（${ngFound.map(w => `<span class="font-bold underline">${w}</span>`).join(', ')}）</span>
                </div>`;
            }

            return `
            <div class="bg-white dark:bg-slate-800 rounded-xl p-5 card-shadow border border-slate-100 dark:border-slate-700">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="font-bold text-slate-700 dark:text-slate-200 text-sm flex items-center gap-2">
                        <span class="w-1 h-4 bg-brand-500 rounded-full inline-block"></span>
                        ${item.title}
                    </h3>
                    <button onclick="copyToClipboard(this)" class="text-xs text-brand-600 dark:text-brand-400 font-bold hover:bg-brand-50 dark:hover:bg-slate-700 px-2 py-1 rounded transition flex items-center gap-1">
                        <i data-lucide="copy" class="h-3 w-3"></i> コピー
                    </button>
                </div>
                <textarea readonly class="w-full bg-slate-50 dark:bg-slate-900 text-slate-700 dark:text-slate-300 border border-slate-200 dark:border-slate-600 rounded-lg p-3 text-sm focus:outline-none resize-none overflow-hidden h-auto leading-relaxed auto-resize" style="min-height: 80px;">${item.text}</textarea>
                ${ngHtml}
            </div>
            `;
        }

        // --- Improved Textarea Height Adjustment ---
        function adjustTextareaHeight(el) {
            if(!el) return;
            el.style.height = 'auto';
            el.style.height = (el.scrollHeight + 5) + 'px';
        }

        // --- Added Helper for Presets ---
        function applyPreset(targetId, value) {
            if (!value) return;
            const target = document.getElementById(targetId);
            target.value = value;
            generateAll(); // Save and Generate
            
            // Adjust height
            target.style.height = 'auto';
            target.style.height = (target.scrollHeight + 5) + 'px';
        }

        function openAssetFolder() {
            // Placeholder action for opening folder
            alert('【画像・動画ホルダー】\n実際の運用では、ここにGoogle DriveやDropbox、社内サーバーへのリンクを設定します。\n\n例：\n・外観写真\n・内観写真\n・お客様インタビュー動画');
        }

        function loadDemoData() {
            // Fill with Business Support Demo Data
            document.getElementById('input_companyName').value = '株式会社ビジネスサポート';
            document.getElementById('input_location').value = '埼玉県さいたま市南区南浦和３丁目４４−１８';
            document.getElementById('input_business').value = '中小企業向けIT導入支援・経営コンサルティング・補助金申請サポート';
            
            document.getElementById('input_story_why').value = '「お客様支援を主願とし、お客様の発展に無限のお役立ちを図る」\nこれが創業以来の変わらぬ想いです。\nIT導入やDXは手段に過ぎません。その先にあるお客様の「満足」と、協業様との「共生」を実現し、地域社会と共に発展し続けることを目指しています。';
            
            document.getElementById('input_values').value = 'お客様の期待を超えたサービスで、常に感動を提供する';
            
            document.getElementById('input_strength_custom').value = '埼玉県内の中小企業に特化した、顔の見える距離感でのきめ細やかなDX支援';
            
            document.getElementById('input_sdgs_future').value = '地域企業の持続的な発展を支え、次世代に豊かな産業基盤を引き継ぐ（ゴール9：産業と技術革新）';
            
            document.getElementById('input_case').value = '【製造業DX事例】\nアナログ管理だった老舗工場様に生産管理システムを導入。\n現場への丁寧なヒアリングと「ものづくり補助金」の活用により、初期コストを抑えつつ、月間40時間の事務作業削減と納期遵守率100%を達成しました。';
            document.getElementById('input_recruit_target').value = '素直で学習意欲があり、チームワークを大切にする20代～30代';
            document.getElementById('input_growth_vision').value = '3年後には単独でお客様の経営課題を解決できるコンサルタントへ';
            
            // Check boxes based on strengths
            document.querySelectorAll('.strength-check').forEach(cb => cb.checked = false);
            // Assuming order: 地域密着, 一貫対応, 初心者, スピード, 伴走型, 実績
            const strengths = ['地域密着', '一貫対応', '伴走型', '実績豊富'];
            document.querySelectorAll('.strength-check').forEach(cb => {
                if(strengths.some(s => cb.parentElement.textContent.includes(s))) {
                    cb.checked = true;
                }
            });
            
            // Check SDGs
            document.querySelectorAll('.sdgs-check').forEach(cb => cb.checked = false);
            // 8, 9, 17
            const sdgVals = ['8', '9', '17'];
            document.querySelectorAll('.sdgs-check').forEach(cb => {
                if(sdgVals.includes(cb.value)) cb.checked = true;
            });
            
            generateAll();
            alert('株式会社ビジネスサポートのデモデータを入力しました');
        }

        function clearAllData() {
            if(!confirm('入力内容をすべて消去しますか？\n（会社情報などの基本設定もクリアされます）')) return;
            
            document.getElementById('input_companyName').value = defaultData.companyName;
            document.getElementById('input_location').value = defaultData.location;
            document.getElementById('input_business').value = defaultData.business;
            document.getElementById('input_story_why').value = '';
            document.getElementById('input_values').value = '';
            document.getElementById('input_strength_custom').value = '';
            document.getElementById('input_sdgs_future').value = '';
            document.getElementById('input_case').value = '';
            document.getElementById('input_recruit_target').value = '';
            document.getElementById('input_growth_vision').value = '';
            
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            
            generateAll();
            alert('データを初期状態（ビジネスサポート設定）に戻しました');
        }
        
        function toggleAllDetails() {
            const details = document.querySelectorAll('details');
            const isAnyOpen = Array.from(details).some(d => d.open);
            
            if (isAnyOpen) {
                // Close all if any are open
                details.forEach(d => d.open = false);
            } else {
                // Open the first one if all are closed
                if(details.length > 0) details[0].open = true;
            }
        }

        function renderOutput(data) {
            const container = document.getElementById('outputContainer');
            let content = [];
            const subTabs = document.getElementById('subTabs');
            
            // Toggle Subtabs
            if (currentCategory === 'branding') {
                subTabs.classList.remove('hidden');
                subTabs.classList.add('flex');
                if (currentSubTab === 'web') content = genWeb(data);
                else if (currentSubTab === 'sales') content = genSales(data);
                else if (currentSubTab === 'exhibition') content = genExhibition(data);
                else if (currentSubTab === 'sns') content = genSNS(data);
                else if (currentSubTab === 'sdgs') content = genSDGs(data);
            } else {
                subTabs.classList.add('hidden');
                subTabs.classList.remove('flex');
                if (currentCategory === 'recruit') content = genRecruit(data);
                else if (currentCategory === 'growth') content = genGrowth(data);
            }

            container.innerHTML = content.map(item => createCard(item, data.ngList)).join('');
            lucide.createIcons();
            setTimeout(() => document.querySelectorAll('.auto-resize').forEach(adjustTextareaHeight), 10);
        }

        function generateAll() {
            saveData();
            const data = getInputs();
            renderOutput(data);
        }

        // --- Improved Tab Switching with Data Attributes ---
        function switchCategory(cat, btn) {
            currentCategory = cat;
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            generateAll();
        }

        function switchSubTab(tab, btn) {
            currentSubTab = tab;
            document.querySelectorAll('#subTabs button').forEach(b => {
                b.classList.remove('sub-tab-active');
                b.classList.add('sub-tab-inactive');
            });
            btn.classList.remove('sub-tab-inactive');
            btn.classList.add('sub-tab-active');
            generateAll();
        }

        function setTone(tone) {
            currentTone = tone;
            document.querySelectorAll('.tone-btn').forEach(btn => {
                btn.classList.remove('active-tone', 'bg-white', 'text-brand-600', 'shadow-sm', 'dark:bg-slate-700', 'dark:text-white');
                btn.classList.add('text-slate-500');
            });
            
            const activeBtn = document.querySelector(`.tone-btn[data-tone="${tone}"]`);
            activeBtn.classList.remove('text-slate-500');
            activeBtn.classList.add('active-tone', 'bg-white', 'text-brand-600', 'shadow-sm', 'dark:bg-slate-700', 'dark:text-white');
            
            generateAll();
        }

        // --- Utilities ---
        function copyToClipboard(btn) {
            const text = btn.parentElement.nextElementSibling.value;
            navigator.clipboard.writeText(text).then(() => {
                const toast = document.getElementById('toast');
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            }).catch(err => {
                console.error('Copy failed', err);
            });
        }

        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            // Save preference could be added here
        }

        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        function openSettings() { openModal('settingsModal'); }
        function openHelp() { openModal('helpModal'); }
        function saveSettings() { saveData(); generateAll(); }

        // --- Event Listeners ---
        window.addEventListener('load', loadData);
        
        // Auto-save & Regenerate on input change
        document.querySelectorAll('input, textarea').forEach(el => {
            el.addEventListener('blur', generateAll);
        });
        document.querySelectorAll('input[type="radio"], input[type="checkbox"]').forEach(el => {
            el.addEventListener('change', generateAll);
        });
        
        // Window resize event to adjust textarea height
        window.addEventListener('resize', () => {
             document.querySelectorAll('.auto-resize').forEach(adjustTextareaHeight);
        });

    </script>
</body>
</html>