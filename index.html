<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BS Brand Note | ç¤¾é•·ã®æƒ³ã„ã‚’ã€äº‹æ¥­ã®æ­¦å™¨ã«ã€‚</title>
    <!-- Tailwind CSS (Design System) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts (Noto Sans JP) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7', // Trust Blue
                            700: '#0369a1',
                            900: '#0c4a6e',
                        },
                        accent: {
                            500: '#f59e0b', // Action Orange
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            /* Desktop: Prevent whole page scroll, handle in columns */
            height: 100vh;
            overflow: hidden; 
        }
        
        /* Mobile: Allow normal scrolling */
        @media (max-width: 1024px) {
            body {
                height: auto;
                overflow: auto;
            }
        }
        
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card-shadow:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Improved Scrollbar Styling */
        .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 transparent;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 10px; /* Slightly wider for easier grabbing */
            height: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent; 
            margin: 4px 0;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 6px;
            border: 2px solid rgba(0,0,0,0); /* Creates padding effect */
            background-clip: padding-box;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
            border: 2px solid rgba(0,0,0,0);
            background-clip: padding-box;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #475569;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        
        /* Tab Styles */
        .tab-active {
            background-color: #0284c7;
            color: #ffffff;
            font-weight: 700;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transform: translateY(-1px);
        }
        .dark .tab-active {
            background-color: #0ea5e9;
            color: #ffffff;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }
        .tab-inactive {
            color: #64748b;
            font-weight: 500;
            background-color: transparent;
        }
        .tab-inactive:hover {
            color: #334155;
            background-color: rgba(0, 0, 0, 0.05);
        }
        .dark .tab-inactive:hover {
            color: #cbd5e1;
            background-color: rgba(255, 255, 255, 0.05);
        }

        .toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 16px;
            position: fixed;
            z-index: 50;
            left: 50%;
            bottom: 30px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s, bottom 0.3s;
        }
        .toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 50px;
        }
        .ng-badge {
            background-color: #fee2e2;
            color: #ef4444;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-right: 4px;
            margin-bottom: 4px;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 dark:bg-slate-900 dark:text-slate-100 flex flex-col h-screen overflow-hidden">

    <!-- Header -->
    <header class="bg-brand-900 text-white shadow-lg sticky top-0 z-40 flex-none h-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex items-center justify-between">
            <div class="flex items-center gap-3">
                <!-- Logo Image: bs.jpg -->
                <img src="bs.jpg" alt="BS Logo" class="h-10 w-auto rounded bg-white p-0.5 shadow-sm">
                
                <div>
                    <h1 class="font-bold text-lg leading-tight">BS Brand Note</h1>
                    <p class="text-[10px] text-brand-100 opacity-90 leading-tight">ç¤¾é•·ã®æƒ³ã„ã‚’ã€äº‹æ¥­ã®æ­¦å™¨ã«ã€‚</p>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleDarkMode()" class="p-2 rounded-full hover:bg-white/10 transition text-white/90 hover:text-white" title="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰">
                    <i data-lucide="moon" class="h-5 w-5"></i>
                </button>
                <button onclick="openHelp()" class="p-2 rounded-full hover:bg-white/10 transition text-white/90 hover:text-white" title="ä½¿ã„æ–¹">
                    <i data-lucide="help-circle" class="h-5 w-5"></i>
                </button>
                <button onclick="openSettings()" class="flex items-center gap-1 bg-white/10 hover:bg-white/20 text-white px-3 py-1.5 rounded-full transition text-xs font-bold" title="è¨­å®šãƒ»åŸºæœ¬æƒ…å ±">
                    <i data-lucide="settings" class="h-4 w-4"></i> è¨­å®šãƒ»åŸºæœ¬æƒ…å ±
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-[1600px] w-full mx-auto p-4 sm:p-6 lg:p-8 grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8 h-[calc(100vh-4rem)] overflow-hidden">
        
        <!-- Left Column: Inputs (Improved Scroll) -->
        <section class="lg:col-span-5 flex flex-col gap-6 lg:h-full lg:overflow-y-auto custom-scrollbar pr-2 pb-24">
            <div class="flex justify-between items-center mb-1 sticky top-0 bg-slate-50 dark:bg-slate-900 z-10 py-2">
                <h2 class="text-xl font-bold flex items-center gap-2 text-brand-700 dark:text-brand-400">
                    <i data-lucide="pen-tool" class="h-5 w-5"></i> æ€è€ƒã®æ•´ç†ï¼ˆå…¥åŠ›ï¼‰
                </h2>
                <!-- Removed Status from here -->
            </div>

            <!-- Tone Selector -->
            <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 flex-shrink-0">
                <label class="text-xs font-bold text-slate-500 uppercase mb-2 block">å‡ºåŠ›ãƒˆãƒ¼ãƒ³ï¼ˆèªã‚Šå£ï¼‰</label>
                <div class="flex bg-slate-100 dark:bg-slate-900 rounded-lg p-1">
                    <button class="tone-btn flex-1 py-2 text-sm rounded-md font-medium transition active-tone" data-tone="polite" onclick="setTone('polite')">ä¸å¯§ãƒ»èª å®Ÿ</button>
                    <button class="tone-btn flex-1 py-2 text-sm rounded-md font-medium transition text-slate-500" data-tone="passion" onclick="setTone('passion')">ç†±é‡ãƒ»æƒ³ã„</button>
                    <button class="tone-btn flex-1 py-2 text-sm rounded-md font-medium transition text-slate-500" data-tone="friendly" onclick="setTone('friendly')">è¦ªã—ã¿ãƒ»ç›¸è«‡</button>
                </div>
            </div>

            <!-- Section A: Passion -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0" open>
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">A. ç¤¾é•·ã®æƒ³ã„ãƒ»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">ãªãœã“ã®äº‹æ¥­ã‚’ã‚„ã£ã¦ã„ã‚‹ï¼Ÿï¼ˆåŸä½“é¨“ï¼‰</label>
                        <!-- Preset Select -->
                        <div class="relative">
                            <select id="select_story_why" class="w-full appearance-none bg-brand-50 dark:bg-slate-700 border border-brand-200 dark:border-slate-600 rounded-lg py-2 px-3 mb-2 text-xs text-brand-700 dark:text-slate-300 outline-none transition hover:bg-brand-100 dark:hover:bg-slate-600 cursor-pointer font-medium" onchange="applyPreset('input_story_why', this.value)">
                                <option value="">â–¼ ä¾‹æ–‡ã‚’é¸æŠã—ã¦å…¥åŠ›ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§åæ˜ ï¼‰</option>
                                <option value="ä¸­å°ä¼æ¥­ã«ã¯ã€&#13;&#10;ãã‚Œãã‚Œã®æ­´å²ãŒã‚ã‚Šã€&#13;&#10;ãã‚Œãã‚Œã®äº‹æƒ…ãŒã‚ã‚Šã€&#13;&#10;ãã‚Œãã‚Œã®â€œã‚‰ã—ã•â€ãŒã‚ã‚Šã¾ã™ã€‚&#13;&#10;ç§ãŸã¡ã¯ã€&#13;&#10;&#13;&#10;ãã®â€œã‚‰ã—ã•â€ã‚’å£Šã™DXã§ã¯ãªãã€&#13;&#10;&#13;&#10;ãã®â€œã‚‰ã—ã•â€ã‚’æ´»ã‹ã™DXã‚’ä¸€ç·’ã«è€ƒãˆãŸã„ã€‚&#13;&#10;ITãŒå¾—æ„ãªä¼šç¤¾ã ã‘ãŒä¼¸ã³ã‚‹æ™‚ä»£ã§ã¯ãªãã€&#13;&#10;&#13;&#10;ITãŒè‹¦æ‰‹ãªä¼šç¤¾ã»ã©ã€&#13;&#10;ã¡ã‚ƒã‚“ã¨æ”¯ãˆã‚‰ã‚Œã‚‹å­˜åœ¨ã§ã‚ã‚ŠãŸã„ã€‚">ä¾‹æ–‡ï¼šãã®â€œã‚‰ã—ã•â€ã‚’æ´»ã‹ã™DXï¼ˆä¸­å°ä¼æ¥­æ”¯æ´ï¼‰</option>
                            </select>
                            <i data-lucide="chevron-down" class="absolute right-3 top-2.5 h-4 w-4 text-brand-400 pointer-events-none"></i>
                        </div>
                        <textarea id="input_story_why" rows="3" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize leading-relaxed" placeholder="ã“ã“ã«è‡ªç”±ã«å…¥åŠ›ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">å¤§åˆ‡ã«ã—ã¦ã„ã‚‹ä¾¡å€¤è¦³</label>
                        <!-- Preset Select -->
                        <div class="relative">
                            <select id="select_values" class="w-full appearance-none bg-brand-50 dark:bg-slate-700 border border-brand-200 dark:border-slate-600 rounded-lg py-2 px-3 mb-2 text-xs text-brand-700 dark:text-slate-300 outline-none transition hover:bg-brand-100 dark:hover:bg-slate-600 cursor-pointer font-medium" onchange="applyPreset('input_values', this.value)">
                                <option value="">â–¼ ä¾‹æ–‡ã‚’é¸æŠã—ã¦å…¥åŠ›ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§åæ˜ ï¼‰</option>
                                <option value="åŸ¼ç‰ã‚’æ‹ ç‚¹ã«ã€&#13;&#10;åœ°åŸŸã®ä¸­å°ä¼æ¥­ã¨ä¸€ç·’ã«æ­©ã‚“ã§ããŸã“ã¨ã¯&#13;&#10;ç§ãŸã¡ã®èª‡ã‚Šã§ã™ã€‚&#13;&#10;é¡”ãŒè¦‹ãˆã‚‹è·é›¢æ„Ÿã§ã€&#13;&#10;&#13;&#10;ä½•ã‹ã‚ã‚Œã°ã™ãé§†ã‘ã¤ã‘ã‚‹ã€‚&#13;&#10;åœ°åŸŸã®ä¼šç¤¾ãŒå…ƒæ°—ã«ãªã‚‹ã“ã¨ãŒã€&#13;&#10;&#13;&#10;ã“ã®è¡—ã®æœªæ¥ã‚’ã¤ãã‚‹ã¨&#13;&#10;æœ¬æ°—ã§æ€ã£ã¦ã„ã¾ã™ã€‚">ä¾‹æ–‡ï¼šåœ°åŸŸå¯†ç€ãƒ»ä¼´èµ°æ”¯æ´ï¼ˆåŸ¼ç‰æ‹ ç‚¹ï¼‰</option>
                            </select>
                            <i data-lucide="chevron-down" class="absolute right-3 top-2.5 h-4 w-4 text-brand-400 pointer-events-none"></i>
                        </div>
                        <textarea id="input_values" rows="3" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize leading-relaxed" placeholder="ä¾‹ï¼šç¾å ´ä¸»ç¾©ã€ã‚ã‹ã‚Šã‚„ã™ã„è¨€è‘‰ã§ä¼ãˆã‚‹"></textarea>
                    </div>
                </div>
            </details>

            <!-- Section B: Strengths -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0">
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">B. ä¼šç¤¾ã®å¼·ã¿</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-5">
                    <div class="grid grid-cols-2 gap-3">
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="åœ°åŸŸå¯†ç€">
                            <span>åœ°åŸŸå¯†ç€</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="ä¸€è²«å¯¾å¿œ">
                            <span>ä¸€è²«å¯¾å¿œ</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="åˆå¿ƒè€…ã«ã‚‚å„ªã—ã„">
                            <span>ITãŒè‹¦æ‰‹ã§ã‚‚å®‰å¿ƒ</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="ã‚¹ãƒ”ãƒ¼ãƒ‰å¯¾å¿œ">
                            <span>ã‚¹ãƒ”ãƒ¼ãƒ‰å¯¾å¿œ</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="ä¼´èµ°å‹">
                            <span>ä¼´èµ°å‹ã‚µãƒãƒ¼ãƒˆ</span>
                        </label>
                        <label class="flex items-center space-x-2 text-sm p-2 rounded border border-transparent hover:bg-brand-50 hover:border-brand-200 dark:hover:bg-slate-700 cursor-pointer transition">
                            <input type="checkbox" class="strength-check text-brand-600 focus:ring-brand-500 rounded h-4 w-4" value="å®Ÿç¸¾è±Šå¯Œ">
                            <span>å®Ÿç¸¾ãŒè±Šå¯Œ</span>
                        </label>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">ç‹¬è‡ªã®å¼·ã¿ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰</label>
                        <textarea id="input_strength_custom" rows="2" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize" placeholder="ä¾‹ï¼šå…ƒéŠ€è¡Œå“¡ãŒè³‡é‡‘ç¹°ã‚Šã¾ã§ã‚µãƒãƒ¼ãƒˆã—ã¾ã™"></textarea>
                    </div>
                </div>
            </details>

            <!-- Section C: Target -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0">
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">C. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-3">
                    <div class="space-y-3">
                        <label class="flex items-center space-x-3 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded transition">
                            <input type="radio" name="target" value="ceo" class="text-brand-600 focus:ring-brand-500 h-4 w-4" checked>
                            <span>ä¸­å°ä¼æ¥­ã®çµŒå–¶è€…ï¼ˆå¿™ã—ã„ãƒ»å­¤ç‹¬ï¼‰</span>
                        </label>
                        <label class="flex items-center space-x-3 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded transition">
                            <input type="radio" name="target" value="admin" class="text-brand-600 focus:ring-brand-500 h-4 w-4">
                            <span>ç·å‹™ãƒ»çµŒç†æ‹…å½“ï¼ˆæ¥­å‹™éå¤šï¼‰</span>
                        </label>
                        <label class="flex items-center space-x-3 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded transition">
                            <input type="radio" name="target" value="legacy" class="text-brand-600 focus:ring-brand-500 h-4 w-4">
                            <span>ITãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«ãŒè‹¦æ‰‹ãªä¼æ¥­</span>
                        </label>
                        <label class="flex items-center space-x-3 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded transition">
                            <input type="radio" name="target" value="growth" class="text-brand-600 focus:ring-brand-500 h-4 w-4">
                            <span>è£œåŠ©é‡‘æ´»ç”¨ãƒ»DXæ¤œè¨ä¼æ¥­</span>
                        </label>
                    </div>
                </div>
            </details>

            <!-- Section D: SDGs -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0">
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">D. SDGsãƒ»ç¤¾ä¼šè²¢çŒ®</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">æ³¨åŠ›ã™ã‚‹ç›®æ¨™ï¼ˆç•ªå·ã‚’é¸æŠï¼‰</label>
                        <div class="flex flex-wrap gap-2">
                            <label class="cursor-pointer"><input type="checkbox" class="sdgs-check hidden peer" value="8"><span class="px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 peer-checked:bg-[#A21942] peer-checked:text-white transition shadow-sm">8.åƒããŒã„</span></label>
                            <label class="cursor-pointer"><input type="checkbox" class="sdgs-check hidden peer" value="9"><span class="px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 peer-checked:bg-[#FD6925] peer-checked:text-white transition shadow-sm">9.ç”£æ¥­åŸºç›¤</span></label>
                            <label class="cursor-pointer"><input type="checkbox" class="sdgs-check hidden peer" value="11"><span class="px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 peer-checked:bg-[#FD9D24] peer-checked:text-white transition shadow-sm">11.ã¾ã¡ã¥ãã‚Š</span></label>
                            <label class="cursor-pointer"><input type="checkbox" class="sdgs-check hidden peer" value="17"><span class="px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 peer-checked:bg-[#19486A] peer-checked:text-white transition shadow-sm">17.ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼</span></label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">å®Ÿç¾ã—ãŸã„æœªæ¥</label>
                        <textarea id="input_sdgs_future" rows="2" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize" placeholder="ä¾‹ï¼šåœ°åŸŸã®ä¼æ¥­ãŒãšã£ã¨å­˜ç¶šã§ãã‚‹ç¤¾ä¼š"></textarea>
                    </div>
                </div>
            </details>

            <!-- Section E: Achievements -->
            <details class="group bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex-shrink-0">
                <summary class="flex justify-between items-center p-5 cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 transition">
                    <h3 class="font-bold text-base text-slate-700 dark:text-slate-200">E. å®Ÿç¸¾ãƒ»äº‹ä¾‹</h3>
                    <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition"></i>
                </summary>
                <div class="p-5 space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-slate-600 dark:text-slate-400 mb-2">ä»£è¡¨çš„ãªäº‹ä¾‹ãƒ»åŠ¹æœ</label>
                        <textarea id="input_case" rows="2" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-sm focus:ring-2 focus:ring-brand-500 outline-none auto-resize" placeholder="ä¾‹ï¼šã‚¢ãƒŠãƒ­ã‚°ç®¡ç†ã ã£ãŸè£½é€ æ¥­æ§˜ãŒã€ã‚¯ãƒ©ã‚¦ãƒ‰å°å…¥ã§æ®‹æ¥­æ™‚é–“ã‚’50%å‰Šæ¸›ã€‚"></textarea>
                    </div>
                </div>
            </details>

            <!-- Save Status moved here -->
            <div class="text-xs text-slate-400 font-medium text-center mb-1 transition-opacity duration-300 min-h-[1em]" id="saveStatus"></div>

            <button onclick="generateAll()" class="w-full bg-brand-600 hover:bg-brand-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg shadow-brand-500/30 transition transform hover:-translate-y-0.5 active:translate-y-0 flex items-center justify-center gap-2 flex-shrink-0">
                <i data-lucide="wand-2" class="h-5 w-5"></i> ä¿å­˜ã—ã¦ç”Ÿæˆ
            </button>

            <!-- Demo Buttons -->
            <div class="mt-4 pt-4 border-t border-slate-200 dark:border-slate-700 flex justify-center gap-4 text-[10px] text-slate-400">
                <button onclick="loadDemoData()" class="hover:text-brand-500 hover:underline transition">ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›</button>
                <button onclick="clearAllData()" class="hover:text-red-500 hover:underline transition">ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢</button>
            </div>
        </section>

        <!-- Right Column: Outputs -->
        <section class="lg:col-span-7 flex flex-col lg:h-full overflow-hidden">
            <div class="flex justify-between items-center mb-4 flex-shrink-0">
                <h2 class="text-xl font-bold flex items-center gap-2 text-slate-800 dark:text-white">
                    <i data-lucide="monitor-up" class="h-5 w-5 text-accent-500"></i> è³‡ç”£åŒ–ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ
                </h2>
                <button onclick="generateAll()" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 py-1.5 px-3 rounded-lg font-bold flex items-center gap-1 transition">
                    <i data-lucide="rotate-cw" class="h-3 w-3"></i> ãƒªã‚»ãƒƒãƒˆãƒ»å†ç”Ÿæˆ
                </button>
            </div>

            <!-- Tabs -->
            <div class="flex overflow-x-auto space-x-2 bg-slate-100 dark:bg-slate-800 p-2 rounded-xl mb-6 items-center flex-shrink-0 custom-scrollbar pb-3">
                <button data-tab="web" class="tab-btn tab-active shrink-0 py-3 px-4 text-sm rounded-lg transition-all duration-200 text-center whitespace-nowrap" onclick="switchTab('web')">Webãƒ»HPç”¨</button>
                <button data-tab="sns" class="tab-btn tab-inactive shrink-0 py-3 px-4 text-sm rounded-lg transition-all duration-200 text-center whitespace-nowrap" onclick="switchTab('sns')">SNSæŠ•ç¨¿</button>
                <button data-tab="sales" class="tab-btn tab-inactive shrink-0 py-3 px-4 text-sm rounded-lg transition-all duration-200 text-center whitespace-nowrap" onclick="switchTab('sales')">å–¶æ¥­ãƒˆãƒ¼ã‚¯</button>
                <button data-tab="exhibition" class="tab-btn tab-inactive shrink-0 py-3 px-4 text-sm rounded-lg transition-all duration-200 text-center whitespace-nowrap" onclick="switchTab('exhibition')">å±•ç¤ºä¼šãƒ»ãƒãƒ©ã‚·</button>
                <button data-tab="sdgs" class="tab-btn tab-inactive shrink-0 py-3 px-4 text-sm rounded-lg transition-all duration-200 text-center whitespace-nowrap" onclick="switchTab('sdgs')">SDGså®£è¨€</button>
            </div>

            <!-- Output Container (Scrollable) -->
            <div class="flex-grow overflow-y-auto pr-2 pb-24 custom-scrollbar space-y-6" id="outputContainer">
                <!-- Content will be injected here by JS -->
            </div>
        </section>
    </main>

    <!-- Toast Notification -->
    <div id="toast" class="toast shadow-xl">
        <div class="flex items-center justify-center gap-2">
            <i data-lucide="check-circle" class="h-5 w-5 text-green-400"></i>
            <span>ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</span>
        </div>
    </div>

    <!-- Modals -->
    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-md w-full p-6 transform transition-all scale-100 h-[80vh] overflow-y-auto custom-scrollbar">
            <div class="flex justify-between items-center mb-4 sticky top-0 bg-white dark:bg-slate-800 pb-2 z-10 border-b border-slate-100 dark:border-slate-700">
                <h3 class="text-lg font-bold">è¨­å®šãƒ»åŸºæœ¬æƒ…å ±</h3>
                <button onclick="closeModal('settingsModal')" class="text-slate-400 hover:text-slate-600"><i data-lucide="x" class="h-6 w-6"></i></button>
            </div>
            
            <div class="space-y-6">
                <!-- Basic Info Section (Moved from Main) -->
                <div class="bg-slate-50 dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-700">
                    <h4 class="text-sm font-bold text-brand-600 dark:text-brand-400 mb-3 flex items-center gap-1"><i data-lucide="building-2" class="h-4 w-4"></i> ä¼šç¤¾ã®åŸºæœ¬æƒ…å ±</h4>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">ä¼šç¤¾å</label>
                            <input type="text" id="input_companyName" class="w-full bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg p-2.5 text-sm focus:ring-2 focus:ring-brand-500 outline-none" placeholder="ä¾‹ï¼šæ ªå¼ä¼šç¤¾ãƒ“ã‚¸ãƒã‚¹ã‚µãƒãƒ¼ãƒˆ">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">æ‰€åœ¨åœ°</label>
                            <input type="text" id="input_location" class="w-full bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg p-2.5 text-sm outline-none" placeholder="ä¾‹ï¼šæ±äº¬éƒ½ä¸­å¤®åŒº">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">äº‹æ¥­å†…å®¹</label>
                            <textarea id="input_business" rows="2" class="w-full bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg p-2.5 text-sm outline-none" placeholder="ä¾‹ï¼šä¸­å°ä¼æ¥­ã®ITå°å…¥æ”¯æ´ã€æ¥­å‹™æ”¹å–„ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°"></textarea>
                        </div>
                    </div>
                </div>

                <!-- App Settings Section -->
                <div>
                    <h4 class="text-sm font-bold text-slate-700 dark:text-slate-300 mb-3 border-l-4 border-slate-300 pl-2">ã‚¢ãƒ—ãƒªè¨­å®š</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">æ–‡ç« ã®ç½²åï¼ˆãƒ•ãƒƒã‚¿ãƒ¼ï¼‰</label>
                            <input type="text" id="setting_sign" class="w-full bg-slate-50 dark:bg-slate-900 border rounded p-2 text-sm" value="æ ªå¼ä¼šç¤¾ãƒ“ã‚¸ãƒã‚¹ã‚µãƒãƒ¼ãƒˆ">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">è‡ªç¤¾URL</label>
                            <input type="text" id="setting_url" class="w-full bg-slate-50 dark:bg-slate-900 border rounded p-2 text-sm" placeholder="https://example.com">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">Googleãƒãƒƒãƒ—URL</label>
                            <input type="text" id="setting_mapUrl" class="w-full bg-slate-50 dark:bg-slate-900 border rounded p-2 text-sm" placeholder="https://maps.app.goo.gl/...">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">NGãƒ¯ãƒ¼ãƒ‰è¨­å®šï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</label>
                            <textarea id="setting_ng" class="w-full bg-slate-50 dark:bg-slate-900 border rounded p-2 text-sm h-20">çµ¶å¯¾,No.1,å¿…ãš,æ¥­ç•Œåˆ,å®Œç’§,å”¯ä¸€</textarea>
                            <p class="text-[10px] text-red-500 mt-1">â€»èª‡å¤§åºƒå‘Šé˜²æ­¢ã®ãŸã‚ã€ã“ã‚Œã‚‰ã®å˜èªãŒå«ã¾ã‚Œã‚‹ã¨è­¦å‘Šã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>
                        </div>
                    </div>
                </div>

                <div class="pt-2 sticky bottom-0 bg-white dark:bg-slate-800 pb-2">
                    <button onclick="saveSettings(); closeModal('settingsModal')" class="w-full bg-brand-600 text-white py-3 rounded-lg font-bold hover:bg-brand-700 shadow-md">ä¿å­˜ã—ã¦é–‰ã˜ã‚‹</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-lg w-full p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold flex items-center gap-2"><i data-lucide="book-open" class="h-5 w-5 text-accent-500"></i> ä½¿ã„æ–¹ 3ã‚¹ãƒ†ãƒƒãƒ—</h3>
                <button onclick="closeModal('helpModal')" class="text-slate-400 hover:text-slate-600"><i data-lucide="x" class="h-6 w-6"></i></button>
            </div>
            
            <!-- Purpose Section -->
            <div class="bg-brand-50 dark:bg-brand-900/30 p-4 rounded-xl mb-6 border border-brand-100 dark:border-brand-800">
                <h4 class="text-brand-800 dark:text-brand-300 font-bold mb-2 flex items-center gap-2 text-sm">
                    <i data-lucide="target" class="h-4 w-4"></i> ã‚¢ãƒ—ãƒªã®ç›®çš„
                </h4>
                <p class="text-brand-700 dark:text-brand-400 leading-relaxed text-sm">
                    æœ¬ã‚¢ãƒ—ãƒªã¯ã€çµŒå–¶è€…æ§˜ã®å†…ã«ç§˜ã‚ãŸã€Œç†±ã„æƒ³ã„ã€ã‚„ä¼æ¥­ã®ã€Œç‹¬è‡ªã®å¼·ã¿ã€ã‚’è¨€èªåŒ–ã—ã€Webã‚µã‚¤ãƒˆãƒ»å–¶æ¥­æ´»å‹•ãƒ»SNSç™ºä¿¡ãªã©ã§å³æˆ¦åŠ›ã¨ãªã‚‹è¨€è‘‰ã¸ã¨å¤‰æ›ã™ã‚‹ã€äº‹æ¥­è³‡ç”£åŒ–ãƒ„ãƒ¼ãƒ«ã€ã§ã”ã–ã„ã¾ã™ã€‚
                </p>
            </div>

            <div class="space-y-6 text-sm text-slate-600 dark:text-slate-300">
                <div class="flex gap-4">
                    <div class="bg-brand-100 text-brand-600 font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">1</div>
                    <div>
                        <h4 class="font-bold text-slate-800 dark:text-white mb-1">åŸºæœ¬æƒ…å ±ã‚’ã”ç™»éŒ²ãã ã•ã„</h4>
                        <p class="leading-relaxed">ç”»é¢å³ä¸Šã®ã€Œè¨­å®šãƒ»åŸºæœ¬æƒ…å ±ã€ãƒœã‚¿ãƒ³ã‚ˆã‚Šã€è²´ç¤¾ã®åŸºæœ¬æƒ…å ±ï¼ˆç¤¾åã‚„äº‹æ¥­å†…å®¹ãªã©ï¼‰ã‚’ã”å…¥åŠ›ãã ã•ã„ã€‚</p>
                    </div>
                </div>
                <div class="flex gap-4">
                    <div class="bg-brand-100 text-brand-600 font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">2</div>
                    <div>
                        <h4 class="font-bold text-slate-800 dark:text-white mb-1">æƒ³ã„ã‚„å¼·ã¿ã‚’æ•´ç†ãƒ»å…¥åŠ›ã—ã¾ã™</h4>
                        <p class="leading-relaxed">ç”»é¢å·¦å´ã®å…¥åŠ›ã‚¨ãƒªã‚¢ã«ã¦ã€çµŒå–¶ã«å¯¾ã™ã‚‹æƒ³ã„ã€è‡ªç¤¾ã®å¼·ã¿ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå±¤ãªã©ã«ã¤ã„ã¦ã€å•ã„ã‹ã‘ã«ç­”ãˆã‚‹å½¢ã§ã”å…¥åŠ›ãã ã•ã„ã€‚</p>
                    </div>
                </div>
                <div class="flex gap-4">
                    <div class="bg-brand-100 text-brand-600 font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">3</div>
                    <div>
                        <h4 class="font-bold text-slate-800 dark:text-white mb-1">æ–‡ç« ã‚’ç”Ÿæˆã—ã€æ´»ç”¨ã—ã¾ã™</h4>
                        <p class="leading-relaxed">å…¥åŠ›å†…å®¹ã«åŸºã¥ãã€ç”»é¢å³å´ã«ç”¨é€”åˆ¥ã®æ–‡ç« ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚ç›®çš„ã«åˆã£ãŸæ–‡ç« ã‚’é¸ã³ã€ã‚³ãƒ”ãƒ¼ã—ã¦Webã‚µã‚¤ãƒˆã‚„SNSç­‰ã§ã”æ´»ç”¨ãã ã•ã„ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Initialization ---
        lucide.createIcons();

        // --- State Management ---
        let currentTab = 'web';
        let currentTone = 'polite';
        
        const defaultData = {
            companyName: 'æ ªå¼ä¼šç¤¾ãƒ“ã‚¸ãƒã‚¹ã‚µãƒãƒ¼ãƒˆ',
            location: 'ã€’336-0017 åŸ¼ç‰çœŒã•ã„ãŸã¾å¸‚å—åŒºå—æµ¦å’Œï¼“ä¸ç›®ï¼”ï¼”âˆ’ï¼‘ï¼˜',
            business: 'ä¸­å°ä¼æ¥­æ”¯æ´ã€çµŒå–¶ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°',
            story_why: 'ç´ æ™´ã‚‰ã—ã„æŠ€è¡“ã‚’æŒã¤ä¸­å°ä¼æ¥­ãŒã€ä¼ãˆæ–¹ã‚’çŸ¥ã‚‰ãªã„ã ã‘ã§æã‚’ã—ã¦ã„ã‚‹ç¾çŠ¶ã‚’å¤‰ãˆãŸã„ã€‚',
            values: 'ã€Œä¼´èµ°ã€ã¨ã€Œå®Ÿåˆ©ã€',
            strengths: ['åœ°åŸŸå¯†ç€', 'ä¼´èµ°å‹ã‚µãƒãƒ¼ãƒˆ'],
            strength_custom: '',
            target: 'ceo', // ceo, admin, legacy, growth
            sdgs: ['8', '9'],
            sdgs_future: 'åœ°åŸŸã®é›‡ç”¨ã‚’å®ˆã‚Šã€æ¬¡ä¸–ä»£ã«ãƒãƒˆãƒ³ã‚’ç¹‹ã',
            case_study: 'èµ¤å­—ç¶šãã ã£ãŸè£½é€ æ¥­ãŒã€å·¥ç¨‹è¦‹ç›´ã—ã«ã‚ˆã‚ŠVå­—å›å¾©ã‚’é”æˆã€‚',
            settings: {
                sign: 'æ ªå¼ä¼šç¤¾ãƒ“ã‚¸ãƒã‚¹ã‚µãƒãƒ¼ãƒˆ',
                url: 'https://bs-saitama.jp/',
                mapUrl: 'https://maps.app.goo.gl/UGs9YNetsSM7ELRk8',
                ng: 'çµ¶å¯¾,No.1,å¿…ãš,æ¥­ç•Œåˆ,å®Œç’§,å”¯ä¸€'
            }
        };

        // --- Logic: Data Handling ---
        function loadData() {
            const saved = localStorage.getItem('bs_brand_note_data');
            if (saved) {
                const data = JSON.parse(saved);
                // Apply Inputs (Basic Info now in Modal)
                document.getElementById('input_companyName').value = data.companyName || '';
                document.getElementById('input_location').value = data.location || '';
                document.getElementById('input_business').value = data.business || '';
                
                // Other Inputs
                document.getElementById('input_story_why').value = data.story_why || '';
                document.getElementById('input_values').value = data.values || '';
                document.getElementById('input_strength_custom').value = data.strength_custom || '';
                document.getElementById('input_sdgs_future').value = data.sdgs_future || '';
                document.getElementById('input_case').value = data.case_study || '';
                
                // Radio Target
                const targetRadio = document.querySelector(`input[name="target"][value="${data.target}"]`);
                if (targetRadio) targetRadio.checked = true;

                // Checkboxes Strength
                document.querySelectorAll('.strength-check').forEach(cb => {
                    cb.checked = data.strengths.includes(cb.value);
                });

                // Checkboxes SDGs
                document.querySelectorAll('.sdgs-check').forEach(cb => {
                    cb.checked = data.sdgs.includes(cb.value);
                });

                // Settings
                if (data.settings) {
                    document.getElementById('setting_sign').value = data.settings.sign || '';
                    document.getElementById('setting_url').value = data.settings.url || '';
                    document.getElementById('setting_mapUrl').value = data.settings.mapUrl || '';
                    document.getElementById('setting_ng').value = data.settings.ng || '';
                }
            } else {
                // Load defaults if empty
                document.getElementById('input_companyName').value = defaultData.companyName;
                document.getElementById('input_location').value = defaultData.location;
                document.getElementById('input_business').value = defaultData.business;
                document.getElementById('setting_url').value = defaultData.settings.url;
                document.getElementById('setting_mapUrl').value = defaultData.settings.mapUrl;
                
                generateAll(); // Initial Gen
            }
        }

        function saveData() {
            const strengths = Array.from(document.querySelectorAll('.strength-check:checked')).map(cb => cb.value);
            const sdgs = Array.from(document.querySelectorAll('.sdgs-check:checked')).map(cb => cb.value);
            const target = document.querySelector('input[name="target"]:checked')?.value || 'ceo';

            const data = {
                companyName: document.getElementById('input_companyName').value,
                location: document.getElementById('input_location').value,
                business: document.getElementById('input_business').value,
                story_why: document.getElementById('input_story_why').value,
                values: document.getElementById('input_values').value,
                strengths: strengths,
                strength_custom: document.getElementById('input_strength_custom').value,
                target: target,
                sdgs: sdgs,
                sdgs_future: document.getElementById('input_sdgs_future').value,
                case_study: document.getElementById('input_case').value,
                settings: {
                    sign: document.getElementById('setting_sign').value,
                    url: document.getElementById('setting_url').value,
                    mapUrl: document.getElementById('setting_mapUrl').value,
                    ng: document.getElementById('setting_ng').value
                }
            };
            
            localStorage.setItem('bs_brand_note_data', JSON.stringify(data));
            
            // Show saving status
            const status = document.getElementById('saveStatus');
            status.textContent = 'ä¿å­˜ã—ã¾ã—ãŸ';
            status.classList.remove('opacity-0');
            setTimeout(() => status.classList.add('opacity-0'), 2000);
        }

        // --- Logic: Generator Core ---
        
        // Helper: Get Tone Suffix
        function t(polite, passion, friendly) {
            if (currentTone === 'passion') return passion;
            if (currentTone === 'friendly') return friendly;
            return polite;
        }

        function getInputs() {
            const strengths = Array.from(document.querySelectorAll('.strength-check:checked')).map(cb => cb.value);
            if(document.getElementById('input_strength_custom').value) {
                strengths.push(document.getElementById('input_strength_custom').value);
            }
            
            return {
                name: document.getElementById('input_companyName').value || 'å½“ç¤¾',
                loc: document.getElementById('input_location').value,
                biz: document.getElementById('input_business').value,
                why: document.getElementById('input_story_why').value,
                val: document.getElementById('input_values').value,
                str: strengths,
                target: document.querySelector('input[name="target"]:checked')?.value || 'ceo',
                sdgs: Array.from(document.querySelectorAll('.sdgs-check:checked')).map(cb => cb.value),
                future: document.getElementById('input_sdgs_future').value,
                case: document.getElementById('input_case').value,
                sign: document.getElementById('setting_sign').value,
                url: document.getElementById('setting_url').value,
                mapUrl: document.getElementById('setting_mapUrl').value,
                ngList: document.getElementById('setting_ng').value.split(',').map(s => s.trim()).filter(s => s)
            };
        }

        function checkNG(text, ngList) {
            const found = [];
            ngList.forEach(word => {
                if (text.includes(word)) found.push(word);
            });
            return found;
        }

        // --- Generators ---

        function genWeb(d) {
            let strList = d.str.length > 0 ? d.str.join('ã€') : 'ç‹¬è‡ªã®ãƒã‚¦ãƒã‚¦';
            let targetCall = '';
            
            if(d.target === 'ceo') targetCall = 'çµŒå–¶è€…ã®çš†æ§˜ã€å­¤ç‹¬ãªæ±ºæ–­ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚';
            if(d.target === 'admin') targetCall = 'ãƒãƒƒã‚¯ã‚ªãƒ•ã‚£ã‚¹ã®è² æ‹…ã‚’åŠ‡çš„ã«è»½æ¸›ã—ã¾ã™ã€‚';
            if(d.target === 'legacy') targetCall = 'ã€ŒITã¯é›£ã—ã„ã€ã¨è«¦ã‚ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ';
            if(d.target === 'growth') targetCall = 'æ¬¡ãªã‚‹æˆé•·ã®ãŸã‚ã®DXã‚’å…±ã«å®Ÿç¾ã—ã¾ã™ã€‚';

            // Catch Copies
            const copy1 = `${d.loc}ã‹ã‚‰ã€${d.future || 'ä¼æ¥­ã®æœªæ¥'}ã‚’å‰µã‚‹ã€‚${d.name}ã§ã™ã€‚`;
            const copy2 = `${targetCall}\n${strList}ã§ã€ã‚ãªãŸã®äº‹æ¥­ã‚’åŠ é€Ÿã•ã›ã¾ã™ã€‚`;
            const copy3 = `${d.val}ã‚’å¤§åˆ‡ã«ã€‚${d.biz}ãªã‚‰ãŠä»»ã›ãã ã•ã„ã€‚`;

            // Intro Text
            let intro = `${d.name}ã¯ã€${d.loc}ã‚’æ‹ ç‚¹ã«${d.biz}ã‚’å±•é–‹ã—ã¦ã„ã¾ã™ã€‚\n\nå‰µæ¥­ä»¥æ¥ã€ã€Œ${d.why}ã€ã¨ã„ã†æƒ³ã„ã§æ´»å‹•ã‚’ç¶šã‘ã¦ãã¾ã—ãŸã€‚ç§ãŸã¡ã®å¼·ã¿ã¯${strList}ã§ã™ã€‚\n\n${targetCall}ãŠå®¢æ§˜ã®ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã—ã¦ã€${d.future || 'å…±ã«æ­©ã¿ã‚’é€²ã‚ã¦'}ã¾ã„ã‚Šã¾ã™ã€‚`;
            
            if (d.mapUrl) {
                intro += `\n\nã‚¢ã‚¯ã‚»ã‚¹: ${d.mapUrl}`;
            }

            return [
                { title: 'ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ç”¨ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ A', text: copy1 },
                { title: 'ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ç”¨ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ B', text: copy2 },
                { title: 'ä¼šç¤¾ç´¹ä»‹æ–‡ (About Us)', text: intro },
                { title: 'å¼·ã¿ã®ç®‡æ¡æ›¸ã', text: d.str.map(s => `ãƒ»${s}`).join('\n') }
            ];
        }

        function genSales(d) {
            let opening = '';
            if (currentTone === 'polite') opening = `ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚${d.name}ã§ã™ã€‚`;
            else if (currentTone === 'passion') opening = `ãŠä¸–è©±ã«ãªã‚Šã¾ã™ï¼${d.name}ã§ã™ï¼`;
            else opening = `ã“ã‚“ã«ã¡ã¯ã€${d.name}ã§ã™ã€‚`;

            let pain = '';
            if(d.target === 'ceo') pain = 'çµŒå–¶èª²é¡Œã®è§£æ±ºã‚„ã€å°†æ¥ã¸ã®æŠ•è³‡ã«ã¤ã„ã¦ãŠæ‚©ã¿ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ';
            if(d.target === 'legacy') pain = 'æ¥­å‹™ã®ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã‚’é€²ã‚ãŸã„ã‘ã‚Œã©ã€ä½•ã‹ã‚‰å§‹ã‚ã‚Œã°ã„ã„ã‹åˆ†ã‹ã‚‰ãªã„â€¦ã¨ã„ã†ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ';

            const talk30 = `${opening}\n\nç§ãŸã¡ã¯${d.loc}ã§${d.biz}ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚\nç‰¹ã«${d.str[0] || 'ã‚µãƒãƒ¼ãƒˆä½“åˆ¶'}ã«ã¯è‡ªä¿¡ãŒã‚ã‚Šã€${d.case || 'å¤šãã®ãŠå®¢æ§˜'}ã«ã”è©•ä¾¡ã„ãŸã ã„ã¦ã„ã¾ã™ã€‚\n\n${pain}\nã‚‚ã—ã‚ˆã‚ã—ã‘ã‚Œã°ã€ä¸€åº¦è³‡æ–™ã ã‘ã§ã‚‚ã”è¦§ã„ãŸã ã‘ãªã„ã§ã—ã‚‡ã†ã‹ã€‚`;

            let email = `${opening}\n\nè²´ç¤¾ã®Webã‚µã‚¤ãƒˆã‚’æ‹è¦‹ã—ã€ã”é€£çµ¡ã„ãŸã—ã¾ã—ãŸã€‚\n\nå¼Šç¤¾ã¯${d.biz}ã‚’å°‚é–€ã¨ã—ã¦ãŠã‚Šã€ç‰¹ã«ã€Œ${d.val}ã€ã¨ã„ã†ä¾¡å€¤è¦³ã‚’å¤§åˆ‡ã«ã—ã¦ã„ã¾ã™ã€‚\n\nã“ã‚Œã¾ã§ã«${d.case}ã¨ã„ã£ãŸå®Ÿç¸¾ãŒã”ã–ã„ã¾ã™ã€‚\n\n${d.str.join('ã€')}ã¨ã„ã£ãŸå¼·ã¿ã‚’æ´»ã‹ã—ã€è²´ç¤¾ã®ãŠå½¹ã«ç«‹ã¦ã‚‹ã®ã§ã¯ãªã„ã‹ã¨è€ƒãˆã¾ã—ãŸã€‚\n\nè©³ç´°ãªäº‹ä¾‹è³‡æ–™ã‚‚ã”ã–ã„ã¾ã™ã®ã§ã€ä¸€åº¦æƒ…å ±äº¤æ›ã®ãŠæ™‚é–“ã‚’ã„ãŸã ã‘ãªã„ã§ã—ã‚‡ã†ã‹ã€‚\n\n--------------------------------\n${d.sign}\n${d.url}`;
            
            if (d.mapUrl) {
                email += `\nMap: ${d.mapUrl}`;
            }
            email += `\n--------------------------------`;

            return [
                { title: '30ç§’ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ãƒ”ãƒƒãƒ', text: talk30 },
                { title: 'åˆå›ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãƒ¡ãƒ¼ãƒ«', text: email },
                { title: 'å•ã„åˆã‚ã›è¿”ä¿¡', text: `${opening}\nã“ã®åº¦ã¯ã€ãŠå•ã„åˆã‚ã›ã„ãŸã ãèª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\n\nã”è³ªå•ã„ãŸã ã„ãŸä»¶ã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã®é€šã‚Šå›ç­”ã„ãŸã—ã¾ã™ã€‚\n\nï¼ˆã“ã“ã«å›ç­”ã‚’å…¥åŠ›ï¼‰\n\nç§ãŸã¡ã®å¼·ã¿ã§ã‚ã‚‹ã€Œ${d.str[0] || 'å¯¾å¿œåŠ›'}ã€ã‚’æ´»ã‹ã—ã€è²´ç¤¾ã®èª²é¡Œè§£æ±ºã«è²¢çŒ®ã§ãã‚Œã°å¹¸ã„ã§ã™ã€‚\nå¼•ãç¶šãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚\n\n--------------------------------\n${d.sign}` }
            ];
        }

        function genExhibition(d) {
            return [
                { title: 'ãƒ‘ãƒãƒ«ãƒ»ãƒã‚¹ã‚¿ãƒ¼è¦‹å‡ºã—', text: `ã€${d.str[0] || 'è§£æ±ºç­–'}ã€‘${d.biz}ãªã‚‰${d.name}ã¸` },
                { title: 'æ¥å ´è€…ã«åˆºã•ã‚‹ä¸€è¨€ (POP)', text: d.target === 'legacy' ? 'ã€ŒITãŒè‹¦æ‰‹ã€ã§ã‚‚å¤§ä¸ˆå¤«ï¼' : 'ãã®çµŒå–¶èª²é¡Œã€3åˆ†ã§è¨ºæ–­ï¼' },
                { title: 'ãƒãƒ©ã‚·ç”¨ãƒªãƒ¼ãƒ‰æ–‡', text: `ã‚‚ã†ä¸€äººã§æ‚©ã¾ãªã„ã§ãã ã•ã„ã€‚\n${d.loc}ã®${d.name}ãŒã€ã‚ãªãŸã®ä¼šç¤¾ã®ã€Œ${d.val}ã€ã‚’å®ˆã‚Šã¾ã™ã€‚\n\nå®Ÿç¸¾ï¼š${d.case}` },
                { title: 'QRã‚³ãƒ¼ãƒ‰èª˜å°', text: 'è©³ç´°äº‹ä¾‹ãƒ»ãƒã‚¦ãƒã‚¦é›†ã¯ã“ã¡ã‚‰ã‹ã‚‰ã‚¹ãƒãƒ›ã§ãƒã‚§ãƒƒã‚¯â–¼' }
            ];
        }

        function genSNS(d) {
            const tags = `#${d.name.replace(/\s+/g, '')} #${d.loc} #ä¸­å°ä¼æ¥­æ”¯æ´ #${d.biz.split('ã€')[0]}`;
            const mapLink = d.mapUrl ? `\n\nğŸ“ã‚¢ã‚¯ã‚»ã‚¹\n${d.mapUrl}` : '';
            const toneEnd = t('ã§ã™ã€‚', 'ã ï¼', 'ã§ã™ã­âœ¨');
            const emoji = t('ğŸ™‡â€â™‚ï¸', 'ğŸ”¥', 'ğŸ˜Š');

            // Google Maps (Business Profile)
            const googleMap = `ã€ãŠçŸ¥ã‚‰ã›ã€‘${d.case}\n\n${d.name}ã§ã™ã€‚\nãŠå®¢æ§˜ã‚ˆã‚Šå¬‰ã—ã„ãŠå£°ã‚’ã„ãŸã ãã¾ã—ãŸã€‚\n\nç§ãŸã¡ã¯${d.loc}ã§${d.biz}ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚\nã€Œ${d.val}ã€ã‚’å¤§åˆ‡ã«ã€${d.str[0] || 'åœ°åŸŸ'}ã®çš†æ§˜ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚\n\nãŠå›°ã‚Šã®éš›ã¯ãœã²ã”ç›¸è«‡ãã ã•ã„ã€‚${mapLink}`;

            // Facebook (Storytelling, polite)
            const fb = `ã€${d.name}ã®æƒ³ã„ã€‘\nã“ã‚“ã«ã¡ã¯ã€${d.name}ã§ã™ã€‚\n\nç§ãŸã¡ã¯å‰µæ¥­ä»¥æ¥ã€ã€Œ${d.why}ã€ã¨ã„ã†æƒ³ã„ã§${d.loc}ã®çš†æ§˜ã¨å…±ã«æ­©ã‚“ã§ãã¾ã—ãŸã€‚\n\næœ€è¿‘ã§ã¯ã€${d.case}ã¨ã„ã£ãŸäº‹ä¾‹ã‚‚å¢—ãˆã¦ã„ã¾ã™ã€‚\n\nç§ãŸã¡ãŒå¤§åˆ‡ã«ã—ã¦ã„ã‚‹ã®ã¯ã€Œ${d.val}ã€ã§ã™ã€‚\nã“ã‚Œã‹ã‚‰ã‚‚${d.future || 'åœ°åŸŸç¤¾ä¼š'}ã«è²¢çŒ®ã§ãã‚‹ã‚ˆã†å°½åŠ›ã—ã¦ã¾ã„ã‚Šã¾ã™ã€‚\n\nè©³ã—ãã¯ã“ã¡ã‚‰ï¼š\n${d.url}\n${tags}`;

            // Instagram (Visual, emotional, hashtags)
            const insta = `ã€äº‹ä¾‹ç´¹ä»‹ã€‘${d.case}${emoji}\n.\nãŠå®¢æ§˜ã®ç¬‘é¡”ãŒç§ãŸã¡ã®åŸå‹•åŠ›ã§ã™âœ¨\n.\n${d.name}ã®å¼·ã¿ã¯ã€Œ${d.str[0] || 'å¯¾å¿œåŠ›'}ã€ï¼\nã€Œ${d.val}ã€ã‚’ãƒ¢ãƒƒãƒˆãƒ¼ã«ã€${d.loc}ã§æ´»å‹•ä¸­ğŸ’¨\n.\næ°—ã«ãªã£ãŸæ–¹ã¯ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®ãƒªãƒ³ã‚¯ã‚’ãƒã‚§ãƒƒã‚¯ğŸ‘€\nğŸ‘‡\n@ï¼ˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆåï¼‰\n.\n${tags} #çµŒå–¶è€… #ä¼æ¥­å…¬å¼ #ãƒ“ã‚¸ãƒã‚¹`;

            // X (Twitter) (Short, conclusion first)
            const x = `ã€å®Ÿç¸¾ã€‘${d.case}\n\nå®Ÿã¯ã€Œ${d.str[0] || 'ã“ã‚Œ'}ã€ãŒç§ãŸã¡ã®å¼·ã¿ãªã‚“ã§ã™${toneEnd}\n\n${d.loc}ã§${d.biz}ãªã‚‰${d.name}ã¸ï¼\nã€Œ${d.val}ã€ã®ç²¾ç¥ã§ã‚µãƒãƒ¼ãƒˆã—ã¾ã™${emoji}\n\nè©³ç´°ã¯ã“ã¡ã‚‰ğŸ‘‡\n${d.url}\n${tags}`;

            // LINE (Friendly, direct action)
            const line = `ã“ã‚“ã«ã¡ã¯ï¼${d.name}ã§ã™${emoji}\n\n${d.loc}ã®äº‹æ¥­è€…æ§˜ã¸ã€ã“ã‚“ãªãŠæ‚©ã¿ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ\n\nâœ… ${d.case}\n\nç§ãŸã¡ã¯${d.str.join('ã€')}ã§è§£æ±ºã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ï¼\n\nã¾ãšã¯ã€Œ${d.val}ã€ã®ç²¾ç¥ã§ã€ãŠè©±ã‚’ãŠèãã—ã¾ã™ã€‚\n\nğŸ‘‡ç„¡æ–™ç›¸è«‡ã¯ã“ã¡ã‚‰ã‹ã‚‰\nï¼ˆLINEã®ãƒœã‚¿ãƒ³ã‚„ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¸èª˜å°ï¼‰`;

            const items = [
                { title: 'Googleãƒãƒƒãƒ— (æœ€æ–°æƒ…å ±)', text: googleMap },
                { title: 'Facebook (ä¿¡é ¼æ§‹ç¯‰)', text: fb },
                { title: 'Instagram (å…±æ„Ÿãƒ»èªçŸ¥)', text: insta },
                { title: 'X / Twitter (æ‹¡æ•£ãƒ»é€Ÿå ±)', text: x },
                { title: 'LINEå…¬å¼ (ãƒ•ã‚¡ãƒ³åŒ–)', text: line }
            ];

            // Added Banner Item
            items.push({
                title: 'ç”»åƒãƒ»å‹•ç”»ç´ æãƒ•ã‚©ãƒ«ãƒ€',
                text: 'ç”»åƒï¼šå¤–è¦³ã€å†…è¦³ã€ãŠå®¢æ§˜\nå‹•ç”»ï¼šå¤–è¦³ã€å†…è¦³ã€ãŠå®¢æ§˜',
                type: 'folder'
            });

            return items;
        }

        function genSDGs(d) {
            const goals = d.sdgs.map(n => `ã‚´ãƒ¼ãƒ«${n}`).join('ã€');
            
            const web = `${d.name}ã¯ã€SDGsï¼ˆæŒç¶šå¯èƒ½ãªé–‹ç™ºç›®æ¨™ï¼‰ã®é”æˆã«è²¢çŒ®ã—ã¾ã™ã€‚\n\nç‰¹ã«ã€Œ${goals}ã€ã‚’é‡è¦èª²é¡Œã¨æ‰ãˆã€äº‹æ¥­ã‚’é€šã˜ã¦ã€Œ${d.future}ã€ã‚’å®Ÿç¾ã—ã¾ã™ã€‚\nå…·ä½“çš„ãªå–ã‚Šçµ„ã¿ã¨ã—ã¦ã€${d.biz}ã‚’é€šã˜ãŸåœ°åŸŸä¼æ¥­ã®æŒç¶šåŒ–æ”¯æ´ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚`;

            const talk = `å¼Šç¤¾ã¯SDGsã«ã‚‚åŠ›ã‚’å…¥ã‚Œã¦ãŠã‚Šã¾ã—ã¦ã€ç‰¹ã«${goals}ç•ªã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã™ã€‚\n${d.future}ã‚’ç›®æŒ‡ã—ã¦ã€ãŠå®¢æ§˜ã¨ä¸€ç·’ã«ç¤¾ä¼šèª²é¡Œã®è§£æ±ºã«å–ã‚Šçµ„ã‚“ã§ã„ã‘ã‚Œã°ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚`;

            return [
                { title: 'Webæ²è¼‰ç”¨ SDGså®£è¨€', text: web },
                { title: 'å–¶æ¥­ãƒˆãƒ¼ã‚¯ç”¨ SDGsã‚¢ãƒ”ãƒ¼ãƒ«', text: talk },
                { title: 'è¡Œæ”¿ãƒ»å…¥æœ­ç”¨ èª¬æ˜æ–‡', text: `ã€SDGsã¸ã®å–ã‚Šçµ„ã¿æ–¹é‡ã€‘\nå½“ç¤¾ã¯ã€${d.biz}ã‚’é€šã˜ã¦æŒç¶šå¯èƒ½ãªç¤¾ä¼šã®å®Ÿç¾ã«å¯„ä¸ã—ã¾ã™ã€‚\né‡ç‚¹ç›®æ¨™ï¼š${goals}\n\nå…·ä½“çš„ã«ã¯ã€${d.str.join('ã€')}ã¨ã„ã£ãŸå¼·ã¿ã‚’æ´»ã‹ã—ã€åœ°åŸŸçµŒæ¸ˆã®æ´»æ€§åŒ–ã¨é›‡ç”¨ã®ç¶­æŒï¼ˆã‚´ãƒ¼ãƒ«8ï¼‰ã«è²¢çŒ®ã—ã¦ã„ã¾ã™ã€‚` }
            ];
        }

        // --- Rendering ---
        function createCard(item, ngList) {
            // Special rendering for Folder Banner
            if (item.type === 'folder') {
                return `
                <div class="bg-brand-50 dark:bg-slate-800 rounded-xl p-4 border-2 border-dashed border-brand-300 dark:border-slate-600 hover:bg-brand-100 dark:hover:bg-slate-700 transition cursor-pointer group" onclick="openAssetFolder()">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="bg-brand-500 text-white p-3 rounded-lg">
                                <i data-lucide="folder-open" class="h-6 w-6"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-brand-700 dark:text-brand-300 text-base">ç”»åƒãƒ»å‹•ç”»ãƒ›ãƒ«ãƒ€ãƒ¼</h3>
                                <p class="text-xs text-brand-600 dark:text-slate-400 mt-1">ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç´ æã‚’ç¢ºèª</p>
                            </div>
                        </div>
                        <i data-lucide="chevron-right" class="h-5 w-5 text-brand-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <div class="mt-3 pl-14 text-sm text-slate-600 dark:text-slate-300 space-y-1">
                        <div class="flex items-center gap-2"><i data-lucide="image" class="h-4 w-4"></i> ç”»åƒï¼šå¤–è¦³ã€å†…è¦³ã€ãŠå®¢æ§˜</div>
                        <div class="flex items-center gap-2"><i data-lucide="film" class="h-4 w-4"></i> å‹•ç”»ï¼šå¤–è¦³ã€å†…è¦³ã€ãŠå®¢æ§˜</div>
                    </div>
                </div>
                `;
            }

            const ngFound = checkNG(item.text, ngList);
            let ngHtml = '';
            if (ngFound.length > 0) {
                ngHtml = `<div class="mt-2 p-3 bg-red-50 border border-red-100 rounded-lg text-sm text-red-700 flex flex-wrap items-start">
                    <i data-lucide="alert-triangle" class="h-4 w-4 mr-1.5 mt-0.5 flex-shrink-0"></i>
                    <span class="flex-1 leading-relaxed">æ³¨æ„ï¼šèª‡å¤§è¡¨ç¾ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆ${ngFound.map(w => `<span class="font-bold underline">${w}</span>`).join(', ')}ï¼‰</span>
                </div>`;
            }

            return `
            <div class="bg-white dark:bg-slate-800 rounded-xl p-5 card-shadow border border-slate-100 dark:border-slate-700">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="font-bold text-slate-700 dark:text-slate-200 text-sm flex items-center gap-2">
                        <span class="w-1 h-4 bg-brand-500 rounded-full inline-block"></span>
                        ${item.title}
                    </h3>
                    <button onclick="copyToClipboard(this)" class="text-xs text-brand-600 dark:text-brand-400 font-bold hover:bg-brand-50 dark:hover:bg-slate-700 px-2 py-1 rounded transition flex items-center gap-1">
                        <i data-lucide="copy" class="h-3 w-3"></i> ã‚³ãƒ”ãƒ¼
                    </button>
                </div>
                <textarea readonly class="w-full bg-slate-50 dark:bg-slate-900 text-slate-700 dark:text-slate-300 border border-slate-200 dark:border-slate-600 rounded-lg p-3 text-sm focus:outline-none resize-none overflow-hidden h-auto leading-relaxed auto-resize" style="min-height: 80px;">${item.text}</textarea>
                ${ngHtml}
            </div>
            `;
        }

        // --- Improved Textarea Height Adjustment ---
        function adjustTextareaHeight(el) {
            if(!el) return;
            el.style.height = 'auto';
            el.style.height = (el.scrollHeight + 5) + 'px';
        }

        // --- Added Helper for Presets ---
        function applyPreset(targetId, value) {
            if (!value) return;
            const target = document.getElementById(targetId);
            target.value = value;
            generateAll(); // Save and Generate
            
            // Adjust height
            target.style.height = 'auto';
            target.style.height = (target.scrollHeight + 5) + 'px';
        }

        function openAssetFolder() {
            // Placeholder action for opening folder
            alert('ã€ç”»åƒãƒ»å‹•ç”»ãƒ›ãƒ«ãƒ€ãƒ¼ã€‘\nå®Ÿéš›ã®é‹ç”¨ã§ã¯ã€ã“ã“ã«Google Driveã‚„Dropboxã€ç¤¾å†…ã‚µãƒ¼ãƒãƒ¼ã¸ã®ãƒªãƒ³ã‚¯ã‚’è¨­å®šã—ã¾ã™ã€‚\n\nä¾‹ï¼š\nãƒ»å¤–è¦³å†™çœŸ\nãƒ»å†…è¦³å†™çœŸ\nãƒ»ãŠå®¢æ§˜ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼å‹•ç”»');
        }

        function loadDemoData() {
            // Fill with Business Support Demo Data
            document.getElementById('input_companyName').value = 'æ ªå¼ä¼šç¤¾ãƒ“ã‚¸ãƒã‚¹ã‚µãƒãƒ¼ãƒˆ';
            document.getElementById('input_location').value = 'åŸ¼ç‰çœŒã•ã„ãŸã¾å¸‚å—åŒºå—æµ¦å’Œï¼“ä¸ç›®ï¼”ï¼”âˆ’ï¼‘ï¼˜';
            document.getElementById('input_business').value = 'ä¸­å°ä¼æ¥­å‘ã‘ITå°å…¥æ”¯æ´ãƒ»çµŒå–¶ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ãƒ»è£œåŠ©é‡‘ç”³è«‹ã‚µãƒãƒ¼ãƒˆ';
            
            document.getElementById('input_story_why').value = 'ã€ŒãŠå®¢æ§˜æ”¯æ´ã‚’ä¸»é¡˜ã¨ã—ã€ãŠå®¢æ§˜ã®ç™ºå±•ã«ç„¡é™ã®ãŠå½¹ç«‹ã¡ã‚’å›³ã‚‹ã€\nã“ã‚ŒãŒå‰µæ¥­ä»¥æ¥ã®å¤‰ã‚ã‚‰ã¬æƒ³ã„ã§ã™ã€‚\nITå°å…¥ã‚„DXã¯æ‰‹æ®µã«éãã¾ã›ã‚“ã€‚ãã®å…ˆã«ã‚ã‚‹ãŠå®¢æ§˜ã®ã€Œæº€è¶³ã€ã¨ã€å”æ¥­æ§˜ã¨ã®ã€Œå…±ç”Ÿã€ã‚’å®Ÿç¾ã—ã€åœ°åŸŸç¤¾ä¼šã¨å…±ã«ç™ºå±•ã—ç¶šã‘ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚';
            
            document.getElementById('input_values').value = 'ãŠå®¢æ§˜ã®æœŸå¾…ã‚’è¶…ãˆãŸã‚µãƒ¼ãƒ“ã‚¹ã§ã€å¸¸ã«æ„Ÿå‹•ã‚’æä¾›ã™ã‚‹';
            
            document.getElementById('input_strength_custom').value = 'åŸ¼ç‰çœŒå†…ã®ä¸­å°ä¼æ¥­ã«ç‰¹åŒ–ã—ãŸã€é¡”ã®è¦‹ãˆã‚‹è·é›¢æ„Ÿã§ã®ãã‚ç´°ã‚„ã‹ãªDXæ”¯æ´';
            
            document.getElementById('input_sdgs_future').value = 'åœ°åŸŸä¼æ¥­ã®æŒç¶šçš„ãªç™ºå±•ã‚’æ”¯ãˆã€æ¬¡ä¸–ä»£ã«è±Šã‹ãªç”£æ¥­åŸºç›¤ã‚’å¼•ãç¶™ãï¼ˆã‚´ãƒ¼ãƒ«9ï¼šç”£æ¥­ã¨æŠ€è¡“é©æ–°ï¼‰';
            
            document.getElementById('input_case').value = 'ã€è£½é€ æ¥­DXäº‹ä¾‹ã€‘\nã‚¢ãƒŠãƒ­ã‚°ç®¡ç†ã ã£ãŸè€èˆ—å·¥å ´æ§˜ã«ç”Ÿç”£ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’å°å…¥ã€‚\nç¾å ´ã¸ã®ä¸å¯§ãªãƒ’ã‚¢ãƒªãƒ³ã‚°ã¨ã€Œã‚‚ã®ã¥ãã‚Šè£œåŠ©é‡‘ã€ã®æ´»ç”¨ã«ã‚ˆã‚Šã€åˆæœŸã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã¤ã¤ã€æœˆé–“40æ™‚é–“ã®äº‹å‹™ä½œæ¥­å‰Šæ¸›ã¨ç´æœŸéµå®ˆç‡100%ã‚’é”æˆã—ã¾ã—ãŸã€‚';
            
            // Check boxes based on strengths
            document.querySelectorAll('.strength-check').forEach(cb => cb.checked = false);
            // Assuming order: åœ°åŸŸå¯†ç€, ä¸€è²«å¯¾å¿œ, åˆå¿ƒè€…, ã‚¹ãƒ”ãƒ¼ãƒ‰, ä¼´èµ°å‹, å®Ÿç¸¾
            const strengths = ['åœ°åŸŸå¯†ç€', 'ä¸€è²«å¯¾å¿œ', 'ä¼´èµ°å‹', 'å®Ÿç¸¾è±Šå¯Œ'];
            document.querySelectorAll('.strength-check').forEach(cb => {
                if(strengths.some(s => cb.parentElement.textContent.includes(s))) {
                    cb.checked = true;
                }
            });
            
            // Check SDGs
            document.querySelectorAll('.sdgs-check').forEach(cb => cb.checked = false);
            // 8, 9, 17
            const sdgVals = ['8', '9', '17'];
            document.querySelectorAll('.sdgs-check').forEach(cb => {
                if(sdgVals.includes(cb.value)) cb.checked = true;
            });
            
            generateAll();
            alert('æ ªå¼ä¼šç¤¾ãƒ“ã‚¸ãƒã‚¹ã‚µãƒãƒ¼ãƒˆã®ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¾ã—ãŸ');
        }

        function clearAllData() {
            if(!confirm('å…¥åŠ›å†…å®¹ã‚’ã™ã¹ã¦æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ\nï¼ˆä¼šç¤¾æƒ…å ±ãªã©ã®åŸºæœ¬è¨­å®šã‚‚ã‚¯ãƒªã‚¢ã•ã‚Œã¾ã™ï¼‰')) return;
            
            // Clear inputs, but maybe we want to keep the default business support info? 
            // The user said "Demo Data Clear", implying clearing the *demo* data.
            // But usually clear means empty. I'll clear fields to empty to be safe, 
            // or reset to defaultData if that's preferred.
            // Let's clear to empty strings to let user start fresh.
            
            // However, the prompt said "Clear Demo Data".
            // If I just clear inputs, it's a "Clear Form".
            // If I reset to "Business Support" defaults, it's a "Reset".
            // Let's assume "Clear" means empty fields for fresh input.
            
            // Wait, if I clear everything, the user loses their settings.
            // Let's reset to the *Default Data* (Business Support) instead of empty?
            // "Demo Data Clear" sounds like "Remove the demo data I just loaded".
            // Since the app starts with Business Support data, I will reset to that.
            
            document.getElementById('input_companyName').value = defaultData.companyName;
            document.getElementById('input_location').value = defaultData.location;
            document.getElementById('input_business').value = defaultData.business;
            document.getElementById('input_story_why').value = '';
            document.getElementById('input_values').value = '';
            document.getElementById('input_strength_custom').value = '';
            document.getElementById('input_sdgs_future').value = '';
            document.getElementById('input_case').value = '';
            
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            
            generateAll();
            alert('ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸçŠ¶æ…‹ï¼ˆãƒ“ã‚¸ãƒã‚¹ã‚µãƒãƒ¼ãƒˆè¨­å®šï¼‰ã«æˆ»ã—ã¾ã—ãŸ');
        }

        function renderOutput(data) {
            const container = document.getElementById('outputContainer');
            let content = [];
            
            if (currentTab === 'web') content = genWeb(data);
            else if (currentTab === 'sales') content = genSales(data);
            else if (currentTab === 'exhibition') content = genExhibition(data);
            else if (currentTab === 'sns') content = genSNS(data);
            else if (currentTab === 'sdgs') content = genSDGs(data);

            container.innerHTML = content.map(item => createCard(item, data.ngList)).join('');
            
            // Re-init icons for new content
            lucide.createIcons();
            
            // Initial Height Adjustment with robust delay
            setTimeout(() => {
                document.querySelectorAll('.auto-resize').forEach(adjustTextareaHeight);
            }, 10);
            
            // Add input listeners for real-time resizing (though these are readonly, good practice)
            document.querySelectorAll('.auto-resize').forEach(tx => {
                tx.addEventListener('input', function() { adjustTextareaHeight(this); });
            });
        }

        function generateAll() {
            saveData();
            const data = getInputs();
            renderOutput(data);
        }

        // --- Improved Tab Switching with Data Attributes ---
        function switchTab(tabName) {
            currentTab = tabName;
            
            // Reset all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('tab-active');
                btn.classList.add('tab-inactive');
            });
            
            // Active current tab safely using data attribute
            const activeBtn = document.querySelector(`.tab-btn[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('tab-active');
                activeBtn.classList.remove('tab-inactive');
            }
            
            generateAll();
        }

        function setTone(tone) {
            currentTone = tone;
            document.querySelectorAll('.tone-btn').forEach(btn => {
                btn.classList.remove('active-tone', 'bg-white', 'text-brand-600', 'shadow-sm', 'dark:bg-slate-700', 'dark:text-white');
                btn.classList.add('text-slate-500');
            });
            
            const activeBtn = document.querySelector(`.tone-btn[data-tone="${tone}"]`);
            activeBtn.classList.remove('text-slate-500');
            activeBtn.classList.add('active-tone', 'bg-white', 'text-brand-600', 'shadow-sm', 'dark:bg-slate-700', 'dark:text-white');
            
            generateAll();
        }

        // --- Utilities ---
        function copyToClipboard(btn) {
            const text = btn.parentElement.nextElementSibling.value;
            navigator.clipboard.writeText(text).then(() => {
                const toast = document.getElementById('toast');
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            }).catch(err => {
                console.error('Copy failed', err);
            });
        }

        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            // Save preference could be added here
        }

        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        function openSettings() { openModal('settingsModal'); }
        function openHelp() { openModal('helpModal'); }
        function saveSettings() { saveData(); generateAll(); }

        // --- Event Listeners ---
        window.addEventListener('load', loadData);
        
        // Auto-save & Regenerate on input change
        document.querySelectorAll('input, textarea').forEach(el => {
            el.addEventListener('blur', generateAll);
        });
        document.querySelectorAll('input[type="radio"], input[type="checkbox"]').forEach(el => {
            el.addEventListener('change', generateAll);
        });
        
        // Window resize event to adjust textarea height
        window.addEventListener('resize', () => {
             document.querySelectorAll('.auto-resize').forEach(adjustTextareaHeight);
        });

    </script>
</body>
</html>